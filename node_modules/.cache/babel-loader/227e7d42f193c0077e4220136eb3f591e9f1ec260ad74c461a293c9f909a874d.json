{"ast":null,"code":"/**\r\n * Hugging Face API Service for QuickDiff React App\r\n * Supports Hugging Face Inference API for text analysis\r\n */\n\nexport class HuggingFaceService {\n  constructor() {\n    this.config = {\n      apiKey: process.env.REACT_APP_HUGGINGFACE_API_KEY || '',\n      // Hugging Face API token from environment\n      baseUrl: 'https://api-inference.huggingface.co/models',\n      models: {\n        textGeneration: 'meta-llama/Llama-2-7b-chat-hf',\n        // Best open-source LLM\n        summarization: 'facebook/bart-large-cnn',\n        // Best summarization model\n        sentiment: 'cardiffnlp/twitter-roberta-base-sentiment-latest',\n        // Best sentiment analysis\n        textClassification: 'unitary/toxic-bert' // For cleanup analysis\n      },\n      maxLength: 1000,\n      temperature: 0.7,\n      waitForModel: true // Wait for model to load if needed\n    };\n\n    // Load config from localStorage if available\n    this.loadConfig();\n  }\n  loadConfig() {\n    try {\n      const savedConfig = localStorage.getItem('quickdiff_hf_config');\n      if (savedConfig) {\n        this.config = {\n          ...this.config,\n          ...JSON.parse(savedConfig)\n        };\n      }\n    } catch (error) {\n      console.error('Error loading Hugging Face config:', error);\n    }\n  }\n  saveConfig() {\n    try {\n      // Don't save API key to localStorage for security\n      const configToSave = {\n        ...this.config\n      };\n      delete configToSave.apiKey;\n      localStorage.setItem('quickdiff_hf_config', JSON.stringify(configToSave));\n    } catch (error) {\n      console.error('Error saving Hugging Face config:', error);\n    }\n  }\n  updateConfig(newConfig) {\n    this.config = {\n      ...this.config,\n      ...newConfig\n    };\n    this.saveConfig();\n  }\n  getConfig() {\n    return {\n      ...this.config\n    };\n  }\n\n  // Check if Hugging Face is properly configured\n  isConfigured() {\n    return this.config.apiKey && this.config.apiKey.trim().length > 0;\n  }\n\n  // Generate analysis using Hugging Face models\n  async generateAnalysis(type, originalText, changedText) {\n    if (!this.isConfigured()) {\n      throw new Error('Hugging Face API not configured. Please set up your API token.');\n    }\n    try {\n      let analysis;\n      switch (type) {\n        case 'explain':\n          analysis = await this.generateExplanation(originalText, changedText);\n          break;\n        case 'rewrite':\n          analysis = await this.generateRewriteSuggestions(originalText, changedText);\n          break;\n        case 'summary':\n          analysis = await this.generateSummary(originalText, changedText);\n          break;\n        case 'tone':\n          analysis = await this.generateToneAnalysis(originalText, changedText);\n          break;\n        case 'cleanup':\n          analysis = await this.generateCleanupAnalysis(originalText, changedText);\n          break;\n        default:\n          analysis = await this.generateExplanation(originalText, changedText);\n      }\n      return this.formatResponse(type, analysis);\n    } catch (error) {\n      console.error('Hugging Face API Error:', error);\n      throw new Error(`Failed to generate ${type} analysis: ${error.message}`);\n    }\n  }\n\n  // Call Hugging Face Inference API\n  async callHuggingFaceAPI(modelName, payload) {\n    const response = await fetch(`${this.config.baseUrl}/${modelName}`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${this.config.apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        ...payload,\n        options: {\n          wait_for_model: this.config.waitForModel,\n          use_cache: true\n        }\n      })\n    });\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Hugging Face API error: ${response.status} - ${error}`);\n    }\n    return await response.json();\n  }\n\n  // Generate text using text generation model\n  async generateText(prompt, maxLength = 500) {\n    var _result$;\n    const result = await this.callHuggingFaceAPI(this.config.models.textGeneration, {\n      inputs: prompt,\n      parameters: {\n        max_length: maxLength,\n        temperature: this.config.temperature,\n        do_sample: true,\n        top_p: 0.9\n      }\n    });\n    return ((_result$ = result[0]) === null || _result$ === void 0 ? void 0 : _result$.generated_text) || '';\n  }\n\n  // Generate explanation analysis\n  async generateExplanation(originalText, changedText) {\n    const stats = this.calculateTextStats(originalText, changedText);\n    const prompt = `Analyze the differences between these two texts and provide insights:\n\nOriginal: \"${originalText.substring(0, 200)}${originalText.length > 200 ? '...' : ''}\"\nChanged: \"${changedText.substring(0, 200)}${changedText.length > 200 ? '...' : ''}\"\n\nKey differences and analysis:`;\n    try {\n      const aiInsight = await this.generateText(prompt, 300);\n      return `\n        <div class=\"ai-explanation\">\n          <h4>üìä Text Analysis</h4>\n          <div class=\"analysis-stats\">\n            <div class=\"stat-item\">\n              <strong>Original Text:</strong> ${stats.originalLines} lines, ${stats.originalWords} words, ${stats.originalChars} characters\n            </div>\n            <div class=\"stat-item\">\n              <strong>Changed Text:</strong> ${stats.changedLines} lines, ${stats.changedWords} words, ${stats.changedChars} characters\n            </div>\n            <div class=\"stat-item\">\n              <strong>Difference:</strong> ${Math.abs(stats.changedLines - stats.originalLines)} lines, ${Math.abs(stats.changedWords - stats.originalWords)} words, ${Math.abs(stats.changedChars - stats.originalChars)} characters\n            </div>\n          </div>\n          \n          <h4>ü§ñ AI Insights</h4>\n          <div class=\"ai-insight\">\n            ${aiInsight.replace(prompt, '').trim()}\n          </div>\n          \n          <h4>üîç Key Changes Detected</h4>\n          <ul>\n            ${stats.originalLines !== stats.changedLines ? `<li>Line count changed from ${stats.originalLines} to ${stats.changedLines}</li>` : ''}\n            ${stats.originalWords !== stats.changedWords ? `<li>Word count changed from ${stats.originalWords} to ${stats.changedWords}</li>` : ''}\n            ${originalText === changedText ? '<li>No changes detected - texts are identical</li>' : ''}\n            ${Math.abs(stats.changedChars - stats.originalChars) > stats.originalChars * 0.5 ? '<li>‚ö†Ô∏è Significant length change detected</li>' : ''}\n          </ul>\n        </div>\n      `;\n    } catch (error) {\n      console.error('Error generating explanation:', error);\n      return this.getFallbackExplanation(originalText, changedText);\n    }\n  }\n\n  // Generate rewrite suggestions\n  async generateRewriteSuggestions(originalText, changedText) {\n    const combinedText = originalText + ' ' + changedText;\n    const prompt = `Provide specific rewrite suggestions for this text to improve clarity, style, and readability:\n\n\"${combinedText.substring(0, 300)}${combinedText.length > 300 ? '...' : ''}\"\n\nSuggestions:`;\n    try {\n      const suggestions = await this.generateText(prompt, 400);\n      return `\n        <div class=\"ai-rewrite\">\n          <h4>‚ú® AI Rewrite Suggestions</h4>\n          <div class=\"ai-suggestions\">\n            ${suggestions.replace(prompt, '').trim()}\n          </div>\n          \n          <h4>üìù General Improvements</h4>\n          <ul>\n            <li>Consider breaking long sentences into shorter, more readable ones</li>\n            <li>Use active voice where possible for clearer communication</li>\n            <li>Ensure consistent terminology throughout the text</li>\n            <li>Remove redundant words and phrases</li>\n          </ul>\n        </div>\n      `;\n    } catch (error) {\n      console.error('Error generating rewrite suggestions:', error);\n      return this.getFallbackRewrite();\n    }\n  }\n\n  // Generate summary using summarization model\n  async generateSummary(originalText, changedText) {\n    const combinedText = originalText + '\\n\\n' + changedText;\n    try {\n      var _result$2;\n      const result = await this.callHuggingFaceAPI(this.config.models.summarization, {\n        inputs: combinedText,\n        parameters: {\n          max_length: 150,\n          min_length: 30,\n          do_sample: false\n        }\n      });\n      const summary = ((_result$2 = result[0]) === null || _result$2 === void 0 ? void 0 : _result$2.summary_text) || 'Unable to generate summary';\n      return `\n        <div class=\"ai-summary\">\n          <h4>üìù AI-Generated Summary</h4>\n          <div class=\"summary-content\">\n            <p>${summary}</p>\n          </div>\n          \n          <h4>üìä Text Overview</h4>\n          <p>Combined text length: ${combinedText.length} characters</p>\n          <p>Analysis includes both original and changed versions for comprehensive understanding.</p>\n        </div>\n      `;\n    } catch (error) {\n      console.error('Error generating summary:', error);\n      return this.getFallbackSummary(originalText, changedText);\n    }\n  }\n\n  // Generate tone analysis using sentiment model\n  async generateToneAnalysis(originalText, changedText) {\n    try {\n      const [originalSentiment, changedSentiment] = await Promise.all([this.analyzeSentiment(originalText), this.analyzeSentiment(changedText)]);\n      return `\n        <div class=\"ai-tone\">\n          <h4>üé≠ AI Tone Analysis</h4>\n          \n          <div class=\"tone-section\">\n            <h5>üìä Original Text Sentiment</h5>\n            <div class=\"sentiment-result\">\n              <strong>Primary Sentiment:</strong> ${originalSentiment.label} (${(originalSentiment.score * 100).toFixed(1)}% confidence)\n            </div>\n          </div>\n          \n          ${changedText ? `\n          <div class=\"tone-section\">\n            <h5>üìä Changed Text Sentiment</h5>\n            <div class=\"sentiment-result\">\n              <strong>Primary Sentiment:</strong> ${changedSentiment.label} (${(changedSentiment.score * 100).toFixed(1)}% confidence)\n            </div>\n          </div>\n          ` : ''}\n          \n          <div class=\"tone-section\">\n            <h5>üí° Tone Insights</h5>\n            <ul>\n              <li>Sentiment analysis powered by Hugging Face AI models</li>\n              <li>Consider your target audience when choosing tone</li>\n              <li>Maintain consistency throughout your document</li>\n              ${originalSentiment.label !== changedSentiment.label ? '<li>‚ö†Ô∏è Tone shift detected between versions</li>' : ''}\n            </ul>\n          </div>\n        </div>\n      `;\n    } catch (error) {\n      console.error('Error generating tone analysis:', error);\n      return this.getFallbackToneAnalysis();\n    }\n  }\n\n  // Analyze sentiment using Hugging Face sentiment model\n  async analyzeSentiment(text) {\n    if (!text.trim()) {\n      return {\n        label: 'NEUTRAL',\n        score: 0.5\n      };\n    }\n    try {\n      const result = await this.callHuggingFaceAPI(this.config.models.sentiment, {\n        inputs: text.substring(0, 500) // Limit text length for API\n      });\n      const topResult = result[0] || {\n        label: 'NEUTRAL',\n        score: 0.5\n      };\n      return topResult;\n    } catch (error) {\n      console.error('Error analyzing sentiment:', error);\n      return {\n        label: 'NEUTRAL',\n        score: 0.5\n      };\n    }\n  }\n\n  // Generate cleanup analysis\n  async generateCleanupAnalysis(originalText, changedText) {\n    const issues = this.detectFormattingIssues(originalText + '\\n' + changedText);\n    return `\n      <div class=\"ai-cleanup\">\n        <h4>üßπ Text Cleanup Analysis</h4>\n        \n        <div class=\"cleanup-section\">\n          <h5>üîç Issues Detected</h5>\n          ${issues.length > 0 ? `\n            <ul>\n              ${issues.map(issue => `<li>${issue}</li>`).join('')}\n            </ul>\n          ` : '<p>‚úÖ No major formatting issues detected!</p>'}\n        </div>\n        \n        <div class=\"cleanup-section\">\n          <h5>‚ú® Cleanup Recommendations</h5>\n          <ul>\n            <li>Remove trailing whitespace at line ends</li>\n            <li>Standardize line break usage</li>\n            <li>Fix inconsistent punctuation</li>\n            <li>Normalize quotation marks</li>\n            <li>Remove unnecessary special characters</li>\n          </ul>\n        </div>\n      </div>\n    `;\n  }\n\n  // Helper methods\n  calculateTextStats(originalText, changedText) {\n    return {\n      originalLines: originalText.split('\\n').length,\n      changedLines: changedText.split('\\n').length,\n      originalWords: originalText.split(/\\s+/).filter(w => w.length > 0).length,\n      changedWords: changedText.split(/\\s+/).filter(w => w.length > 0).length,\n      originalChars: originalText.length,\n      changedChars: changedText.length\n    };\n  }\n  detectFormattingIssues(text) {\n    const issues = [];\n    if (text.includes('  ')) issues.push('Multiple consecutive spaces found');\n    if (text.includes('\\n\\n\\n')) issues.push('Excessive line breaks detected');\n    if (text.match(/[.]{2,}/)) issues.push('Multiple periods found');\n    if (text.match(/[!]{2,}/)) issues.push('Multiple exclamation marks found');\n    if (text.match(/[?]{2,}/)) issues.push('Multiple question marks found');\n    return issues;\n  }\n\n  // Fallback methods for when API calls fail\n  getFallbackExplanation(originalText, changedText) {\n    const stats = this.calculateTextStats(originalText, changedText);\n    const wordDiff = stats.changedWords - stats.originalWords;\n    const lineDiff = stats.changedLines - stats.originalLines;\n    const charDiff = stats.changedChars - stats.originalChars;\n    return `\n      <div class=\"ai-explanation\">\n        <h4>üìä Text Analysis (Local Processing)</h4>\n        <div class=\"analysis-stats\">\n          <div class=\"stat-item\">\n            <strong>Original Text:</strong> ${stats.originalLines} lines, ${stats.originalWords} words, ${stats.originalChars} characters\n          </div>\n          <div class=\"stat-item\">\n            <strong>Changed Text:</strong> ${stats.changedLines} lines, ${stats.changedWords} words, ${stats.changedChars} characters\n          </div>\n          <div class=\"stat-item\">\n            <strong>Net Changes:</strong> ${lineDiff > 0 ? '+' : ''}${lineDiff} lines, ${wordDiff > 0 ? '+' : ''}${wordDiff} words, ${charDiff > 0 ? '+' : ''}${charDiff} characters\n          </div>\n        </div>\n        \n        <h4>üîç Analysis Results</h4>\n        <ul>\n          ${originalText === changedText ? '<li>‚úÖ No changes detected - texts are identical</li>' : ''}\n          ${Math.abs(wordDiff) > 0 ? `<li>üìù Word count ${wordDiff > 0 ? 'increased' : 'decreased'} by ${Math.abs(wordDiff)} words</li>` : ''}\n          ${Math.abs(lineDiff) > 0 ? `<li>üìÑ Line count ${lineDiff > 0 ? 'increased' : 'decreased'} by ${Math.abs(lineDiff)} lines</li>` : ''}\n          ${Math.abs(charDiff) > stats.originalChars * 0.5 ? '<li>‚ö†Ô∏è Significant content change detected (>50% length change)</li>' : ''}\n          ${Math.abs(charDiff) < stats.originalChars * 0.1 ? '<li>‚ú® Minor changes detected (<10% length change)</li>' : ''}\n        </ul>\n        \n        <div class=\"ai-note\">\n          <p><em>Note: This is a local analysis. For AI-powered insights, please check your Hugging Face API configuration.</em></p>\n        </div>\n      </div>\n    `;\n  }\n  getFallbackRewrite() {\n    return `\n      <div class=\"ai-rewrite\">\n        <h4>‚ú® Writing Improvement Suggestions (Local Analysis)</h4>\n        <div class=\"rewrite-suggestions\">\n          <h5>üìù General Writing Tips</h5>\n          <ul>\n            <li><strong>Clarity:</strong> Use clear, concise language and avoid jargon</li>\n            <li><strong>Structure:</strong> Break up long sentences into shorter, more readable ones</li>\n            <li><strong>Voice:</strong> Use active voice when possible for stronger impact</li>\n            <li><strong>Consistency:</strong> Maintain consistent terminology and tone throughout</li>\n            <li><strong>Grammar:</strong> Check for spelling, grammar, and punctuation errors</li>\n          </ul>\n          \n          <h5>üéØ Content Enhancement</h5>\n          <ul>\n            <li>Remove redundant words and phrases</li>\n            <li>Add transitional phrases for better flow</li>\n            <li>Use specific examples to support your points</li>\n            <li>Ensure each paragraph has a clear main idea</li>\n          </ul>\n        </div>\n        \n        <div class=\"ai-note\">\n          <p><em>Note: For AI-powered rewrite suggestions, please configure your Hugging Face API key.</em></p>\n        </div>\n      </div>\n    `;\n  }\n  getFallbackSummary(originalText, changedText) {\n    const combinedLength = originalText.length + changedText.length;\n    return `\n      <div class=\"ai-summary\">\n        <h4>üìù Basic Summary</h4>\n        <p>AI summarization unavailable. Text contains ${combinedLength} total characters across both versions.</p>\n      </div>\n    `;\n  }\n  getFallbackToneAnalysis() {\n    return `\n      <div class=\"ai-tone\">\n        <h4>üé≠ Basic Tone Analysis</h4>\n        <p>AI tone analysis unavailable. Please review your text manually for tone consistency.</p>\n      </div>\n    `;\n  }\n\n  // Format the response into the expected structure\n  formatResponse(type, content) {\n    const typeIcons = {\n      explain: 'üß†',\n      rewrite: '‚ú®',\n      summary: 'üìù',\n      tone: 'üé≠',\n      cleanup: 'üßπ'\n    };\n    const typeTitles = {\n      explain: 'Hugging Face AI Explanation',\n      rewrite: 'Hugging Face AI Rewrite Suggestions',\n      summary: 'Hugging Face AI Summary',\n      tone: 'Hugging Face AI Tone Analysis',\n      cleanup: 'Hugging Face AI Text Cleanup'\n    };\n    return {\n      title: `${typeIcons[type] || 'ü§ñ'} ${typeTitles[type] || 'Hugging Face AI Analysis'}`,\n      content: content,\n      type: type\n    };\n  }\n\n  // Test the Hugging Face connection\n  async testConnection() {\n    try {\n      const result = await this.callHuggingFaceAPI(this.config.models.textGeneration, {\n        inputs: \"Test connection: \",\n        parameters: {\n          max_length: 50\n        }\n      });\n      return {\n        success: true,\n        response: 'Connection successful!'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // Get available models\n  getAvailableModels() {\n    return {\n      textGeneration: ['meta-llama/Llama-2-7b-chat-hf', 'microsoft/DialoGPT-large', 'EleutherAI/gpt-neo-2.7B', 'mistralai/Mistral-7B-Instruct-v0.1', 'EleutherAI/gpt-neo-1.3B'],\n      summarization: ['facebook/bart-large-cnn', 'google/pegasus-xsum', 't5-base', 't5-small'],\n      sentiment: ['cardiffnlp/twitter-roberta-base-sentiment-latest', 'nlptown/bert-base-multilingual-uncased-sentiment', 'distilbert-base-uncased-finetuned-sst-2-english']\n    };\n  }\n}","map":{"version":3,"names":["HuggingFaceService","constructor","config","apiKey","process","env","REACT_APP_HUGGINGFACE_API_KEY","baseUrl","models","textGeneration","summarization","sentiment","textClassification","maxLength","temperature","waitForModel","loadConfig","savedConfig","localStorage","getItem","JSON","parse","error","console","saveConfig","configToSave","setItem","stringify","updateConfig","newConfig","getConfig","isConfigured","trim","length","generateAnalysis","type","originalText","changedText","Error","analysis","generateExplanation","generateRewriteSuggestions","generateSummary","generateToneAnalysis","generateCleanupAnalysis","formatResponse","message","callHuggingFaceAPI","modelName","payload","response","fetch","method","headers","body","options","wait_for_model","use_cache","ok","text","status","json","generateText","prompt","_result$","result","inputs","parameters","max_length","do_sample","top_p","generated_text","stats","calculateTextStats","substring","aiInsight","originalLines","originalWords","originalChars","changedLines","changedWords","changedChars","Math","abs","replace","getFallbackExplanation","combinedText","suggestions","getFallbackRewrite","_result$2","min_length","summary","summary_text","getFallbackSummary","originalSentiment","changedSentiment","Promise","all","analyzeSentiment","label","score","toFixed","getFallbackToneAnalysis","topResult","issues","detectFormattingIssues","map","issue","join","split","filter","w","includes","push","match","wordDiff","lineDiff","charDiff","combinedLength","content","typeIcons","explain","rewrite","tone","cleanup","typeTitles","title","testConnection","success","getAvailableModels"],"sources":["C:/Users/Joem/quickdiff-react/src/utils/HuggingFaceService.js"],"sourcesContent":["/**\r\n * Hugging Face API Service for QuickDiff React App\r\n * Supports Hugging Face Inference API for text analysis\r\n */\r\n\r\nexport class HuggingFaceService {\r\n  constructor() {\r\n    this.config = {\r\n      apiKey: process.env.REACT_APP_HUGGINGFACE_API_KEY || '', // Hugging Face API token from environment\r\n      baseUrl: 'https://api-inference.huggingface.co/models',\r\n      models: {\r\n        textGeneration: 'meta-llama/Llama-2-7b-chat-hf', // Best open-source LLM\r\n        summarization: 'facebook/bart-large-cnn', // Best summarization model\r\n        sentiment: 'cardiffnlp/twitter-roberta-base-sentiment-latest', // Best sentiment analysis\r\n        textClassification: 'unitary/toxic-bert' // For cleanup analysis\r\n      },\r\n      maxLength: 1000,\r\n      temperature: 0.7,\r\n      waitForModel: true // Wait for model to load if needed\r\n    };\r\n    \r\n    // Load config from localStorage if available\r\n    this.loadConfig();\r\n  }\r\n\r\n  loadConfig() {\r\n    try {\r\n      const savedConfig = localStorage.getItem('quickdiff_hf_config');\r\n      if (savedConfig) {\r\n        this.config = { ...this.config, ...JSON.parse(savedConfig) };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading Hugging Face config:', error);\r\n    }\r\n  }\r\n\r\n  saveConfig() {\r\n    try {\r\n      // Don't save API key to localStorage for security\r\n      const configToSave = { ...this.config };\r\n      delete configToSave.apiKey;\r\n      localStorage.setItem('quickdiff_hf_config', JSON.stringify(configToSave));\r\n    } catch (error) {\r\n      console.error('Error saving Hugging Face config:', error);\r\n    }\r\n  }\r\n\r\n  updateConfig(newConfig) {\r\n    this.config = { ...this.config, ...newConfig };\r\n    this.saveConfig();\r\n  }\r\n\r\n  getConfig() {\r\n    return { ...this.config };\r\n  }\r\n\r\n  // Check if Hugging Face is properly configured\r\n  isConfigured() {\r\n    return this.config.apiKey && this.config.apiKey.trim().length > 0;\r\n  }\r\n\r\n  // Generate analysis using Hugging Face models\r\n  async generateAnalysis(type, originalText, changedText) {\r\n    if (!this.isConfigured()) {\r\n      throw new Error('Hugging Face API not configured. Please set up your API token.');\r\n    }\r\n\r\n    try {\r\n      let analysis;\r\n      switch (type) {\r\n        case 'explain':\r\n          analysis = await this.generateExplanation(originalText, changedText);\r\n          break;\r\n        case 'rewrite':\r\n          analysis = await this.generateRewriteSuggestions(originalText, changedText);\r\n          break;\r\n        case 'summary':\r\n          analysis = await this.generateSummary(originalText, changedText);\r\n          break;\r\n        case 'tone':\r\n          analysis = await this.generateToneAnalysis(originalText, changedText);\r\n          break;\r\n        case 'cleanup':\r\n          analysis = await this.generateCleanupAnalysis(originalText, changedText);\r\n          break;\r\n        default:\r\n          analysis = await this.generateExplanation(originalText, changedText);\r\n      }\r\n      \r\n      return this.formatResponse(type, analysis);\r\n    } catch (error) {\r\n      console.error('Hugging Face API Error:', error);\r\n      throw new Error(`Failed to generate ${type} analysis: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  // Call Hugging Face Inference API\r\n  async callHuggingFaceAPI(modelName, payload) {\r\n    const response = await fetch(`${this.config.baseUrl}/${modelName}`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${this.config.apiKey}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        ...payload,\r\n        options: {\r\n          wait_for_model: this.config.waitForModel,\r\n          use_cache: true\r\n        }\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.text();\r\n      throw new Error(`Hugging Face API error: ${response.status} - ${error}`);\r\n    }\r\n\r\n    return await response.json();\r\n  }\r\n\r\n  // Generate text using text generation model\r\n  async generateText(prompt, maxLength = 500) {\r\n    const result = await this.callHuggingFaceAPI(this.config.models.textGeneration, {\r\n      inputs: prompt,\r\n      parameters: {\r\n        max_length: maxLength,\r\n        temperature: this.config.temperature,\r\n        do_sample: true,\r\n        top_p: 0.9\r\n      }\r\n    });\r\n\r\n    return result[0]?.generated_text || '';\r\n  }\r\n\r\n  // Generate explanation analysis\r\n  async generateExplanation(originalText, changedText) {\r\n    const stats = this.calculateTextStats(originalText, changedText);\r\n    \r\n    const prompt = `Analyze the differences between these two texts and provide insights:\r\n\r\nOriginal: \"${originalText.substring(0, 200)}${originalText.length > 200 ? '...' : ''}\"\r\nChanged: \"${changedText.substring(0, 200)}${changedText.length > 200 ? '...' : ''}\"\r\n\r\nKey differences and analysis:`;\r\n\r\n    try {\r\n      const aiInsight = await this.generateText(prompt, 300);\r\n      \r\n      return `\r\n        <div class=\"ai-explanation\">\r\n          <h4>üìä Text Analysis</h4>\r\n          <div class=\"analysis-stats\">\r\n            <div class=\"stat-item\">\r\n              <strong>Original Text:</strong> ${stats.originalLines} lines, ${stats.originalWords} words, ${stats.originalChars} characters\r\n            </div>\r\n            <div class=\"stat-item\">\r\n              <strong>Changed Text:</strong> ${stats.changedLines} lines, ${stats.changedWords} words, ${stats.changedChars} characters\r\n            </div>\r\n            <div class=\"stat-item\">\r\n              <strong>Difference:</strong> ${Math.abs(stats.changedLines - stats.originalLines)} lines, ${Math.abs(stats.changedWords - stats.originalWords)} words, ${Math.abs(stats.changedChars - stats.originalChars)} characters\r\n            </div>\r\n          </div>\r\n          \r\n          <h4>ü§ñ AI Insights</h4>\r\n          <div class=\"ai-insight\">\r\n            ${aiInsight.replace(prompt, '').trim()}\r\n          </div>\r\n          \r\n          <h4>üîç Key Changes Detected</h4>\r\n          <ul>\r\n            ${stats.originalLines !== stats.changedLines ? `<li>Line count changed from ${stats.originalLines} to ${stats.changedLines}</li>` : ''}\r\n            ${stats.originalWords !== stats.changedWords ? `<li>Word count changed from ${stats.originalWords} to ${stats.changedWords}</li>` : ''}\r\n            ${originalText === changedText ? '<li>No changes detected - texts are identical</li>' : ''}\r\n            ${Math.abs(stats.changedChars - stats.originalChars) > stats.originalChars * 0.5 ? '<li>‚ö†Ô∏è Significant length change detected</li>' : ''}\r\n          </ul>\r\n        </div>\r\n      `;\r\n    } catch (error) {\r\n      console.error('Error generating explanation:', error);\r\n      return this.getFallbackExplanation(originalText, changedText);\r\n    }\r\n  }\r\n\r\n  // Generate rewrite suggestions\r\n  async generateRewriteSuggestions(originalText, changedText) {\r\n    const combinedText = originalText + ' ' + changedText;\r\n    const prompt = `Provide specific rewrite suggestions for this text to improve clarity, style, and readability:\r\n\r\n\"${combinedText.substring(0, 300)}${combinedText.length > 300 ? '...' : ''}\"\r\n\r\nSuggestions:`;\r\n\r\n    try {\r\n      const suggestions = await this.generateText(prompt, 400);\r\n      \r\n      return `\r\n        <div class=\"ai-rewrite\">\r\n          <h4>‚ú® AI Rewrite Suggestions</h4>\r\n          <div class=\"ai-suggestions\">\r\n            ${suggestions.replace(prompt, '').trim()}\r\n          </div>\r\n          \r\n          <h4>üìù General Improvements</h4>\r\n          <ul>\r\n            <li>Consider breaking long sentences into shorter, more readable ones</li>\r\n            <li>Use active voice where possible for clearer communication</li>\r\n            <li>Ensure consistent terminology throughout the text</li>\r\n            <li>Remove redundant words and phrases</li>\r\n          </ul>\r\n        </div>\r\n      `;\r\n    } catch (error) {\r\n      console.error('Error generating rewrite suggestions:', error);\r\n      return this.getFallbackRewrite();\r\n    }\r\n  }\r\n\r\n  // Generate summary using summarization model\r\n  async generateSummary(originalText, changedText) {\r\n    const combinedText = originalText + '\\n\\n' + changedText;\r\n    \r\n    try {\r\n      const result = await this.callHuggingFaceAPI(this.config.models.summarization, {\r\n        inputs: combinedText,\r\n        parameters: {\r\n          max_length: 150,\r\n          min_length: 30,\r\n          do_sample: false\r\n        }\r\n      });\r\n\r\n      const summary = result[0]?.summary_text || 'Unable to generate summary';\r\n      \r\n      return `\r\n        <div class=\"ai-summary\">\r\n          <h4>üìù AI-Generated Summary</h4>\r\n          <div class=\"summary-content\">\r\n            <p>${summary}</p>\r\n          </div>\r\n          \r\n          <h4>üìä Text Overview</h4>\r\n          <p>Combined text length: ${combinedText.length} characters</p>\r\n          <p>Analysis includes both original and changed versions for comprehensive understanding.</p>\r\n        </div>\r\n      `;\r\n    } catch (error) {\r\n      console.error('Error generating summary:', error);\r\n      return this.getFallbackSummary(originalText, changedText);\r\n    }\r\n  }\r\n\r\n  // Generate tone analysis using sentiment model\r\n  async generateToneAnalysis(originalText, changedText) {\r\n    try {\r\n      const [originalSentiment, changedSentiment] = await Promise.all([\r\n        this.analyzeSentiment(originalText),\r\n        this.analyzeSentiment(changedText)\r\n      ]);\r\n\r\n      return `\r\n        <div class=\"ai-tone\">\r\n          <h4>üé≠ AI Tone Analysis</h4>\r\n          \r\n          <div class=\"tone-section\">\r\n            <h5>üìä Original Text Sentiment</h5>\r\n            <div class=\"sentiment-result\">\r\n              <strong>Primary Sentiment:</strong> ${originalSentiment.label} (${(originalSentiment.score * 100).toFixed(1)}% confidence)\r\n            </div>\r\n          </div>\r\n          \r\n          ${changedText ? `\r\n          <div class=\"tone-section\">\r\n            <h5>üìä Changed Text Sentiment</h5>\r\n            <div class=\"sentiment-result\">\r\n              <strong>Primary Sentiment:</strong> ${changedSentiment.label} (${(changedSentiment.score * 100).toFixed(1)}% confidence)\r\n            </div>\r\n          </div>\r\n          ` : ''}\r\n          \r\n          <div class=\"tone-section\">\r\n            <h5>üí° Tone Insights</h5>\r\n            <ul>\r\n              <li>Sentiment analysis powered by Hugging Face AI models</li>\r\n              <li>Consider your target audience when choosing tone</li>\r\n              <li>Maintain consistency throughout your document</li>\r\n              ${originalSentiment.label !== changedSentiment.label ? '<li>‚ö†Ô∏è Tone shift detected between versions</li>' : ''}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      `;\r\n    } catch (error) {\r\n      console.error('Error generating tone analysis:', error);\r\n      return this.getFallbackToneAnalysis();\r\n    }\r\n  }\r\n\r\n  // Analyze sentiment using Hugging Face sentiment model\r\n  async analyzeSentiment(text) {\r\n    if (!text.trim()) {\r\n      return { label: 'NEUTRAL', score: 0.5 };\r\n    }\r\n\r\n    try {\r\n      const result = await this.callHuggingFaceAPI(this.config.models.sentiment, {\r\n        inputs: text.substring(0, 500) // Limit text length for API\r\n      });\r\n\r\n      const topResult = result[0] || { label: 'NEUTRAL', score: 0.5 };\r\n      return topResult;\r\n    } catch (error) {\r\n      console.error('Error analyzing sentiment:', error);\r\n      return { label: 'NEUTRAL', score: 0.5 };\r\n    }\r\n  }\r\n\r\n  // Generate cleanup analysis\r\n  async generateCleanupAnalysis(originalText, changedText) {\r\n    const issues = this.detectFormattingIssues(originalText + '\\n' + changedText);\r\n    \r\n    return `\r\n      <div class=\"ai-cleanup\">\r\n        <h4>üßπ Text Cleanup Analysis</h4>\r\n        \r\n        <div class=\"cleanup-section\">\r\n          <h5>üîç Issues Detected</h5>\r\n          ${issues.length > 0 ? `\r\n            <ul>\r\n              ${issues.map(issue => `<li>${issue}</li>`).join('')}\r\n            </ul>\r\n          ` : '<p>‚úÖ No major formatting issues detected!</p>'}\r\n        </div>\r\n        \r\n        <div class=\"cleanup-section\">\r\n          <h5>‚ú® Cleanup Recommendations</h5>\r\n          <ul>\r\n            <li>Remove trailing whitespace at line ends</li>\r\n            <li>Standardize line break usage</li>\r\n            <li>Fix inconsistent punctuation</li>\r\n            <li>Normalize quotation marks</li>\r\n            <li>Remove unnecessary special characters</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  // Helper methods\r\n  calculateTextStats(originalText, changedText) {\r\n    return {\r\n      originalLines: originalText.split('\\n').length,\r\n      changedLines: changedText.split('\\n').length,\r\n      originalWords: originalText.split(/\\s+/).filter(w => w.length > 0).length,\r\n      changedWords: changedText.split(/\\s+/).filter(w => w.length > 0).length,\r\n      originalChars: originalText.length,\r\n      changedChars: changedText.length\r\n    };\r\n  }\r\n\r\n  detectFormattingIssues(text) {\r\n    const issues = [];\r\n    if (text.includes('  ')) issues.push('Multiple consecutive spaces found');\r\n    if (text.includes('\\n\\n\\n')) issues.push('Excessive line breaks detected');\r\n    if (text.match(/[.]{2,}/)) issues.push('Multiple periods found');\r\n    if (text.match(/[!]{2,}/)) issues.push('Multiple exclamation marks found');\r\n    if (text.match(/[?]{2,}/)) issues.push('Multiple question marks found');\r\n    return issues;\r\n  }\r\n\r\n  // Fallback methods for when API calls fail\r\n  getFallbackExplanation(originalText, changedText) {\r\n    const stats = this.calculateTextStats(originalText, changedText);\r\n    const wordDiff = stats.changedWords - stats.originalWords;\r\n    const lineDiff = stats.changedLines - stats.originalLines;\r\n    const charDiff = stats.changedChars - stats.originalChars;\r\n    \r\n    return `\r\n      <div class=\"ai-explanation\">\r\n        <h4>üìä Text Analysis (Local Processing)</h4>\r\n        <div class=\"analysis-stats\">\r\n          <div class=\"stat-item\">\r\n            <strong>Original Text:</strong> ${stats.originalLines} lines, ${stats.originalWords} words, ${stats.originalChars} characters\r\n          </div>\r\n          <div class=\"stat-item\">\r\n            <strong>Changed Text:</strong> ${stats.changedLines} lines, ${stats.changedWords} words, ${stats.changedChars} characters\r\n          </div>\r\n          <div class=\"stat-item\">\r\n            <strong>Net Changes:</strong> ${lineDiff > 0 ? '+' : ''}${lineDiff} lines, ${wordDiff > 0 ? '+' : ''}${wordDiff} words, ${charDiff > 0 ? '+' : ''}${charDiff} characters\r\n          </div>\r\n        </div>\r\n        \r\n        <h4>üîç Analysis Results</h4>\r\n        <ul>\r\n          ${originalText === changedText ? '<li>‚úÖ No changes detected - texts are identical</li>' : ''}\r\n          ${Math.abs(wordDiff) > 0 ? `<li>üìù Word count ${wordDiff > 0 ? 'increased' : 'decreased'} by ${Math.abs(wordDiff)} words</li>` : ''}\r\n          ${Math.abs(lineDiff) > 0 ? `<li>üìÑ Line count ${lineDiff > 0 ? 'increased' : 'decreased'} by ${Math.abs(lineDiff)} lines</li>` : ''}\r\n          ${Math.abs(charDiff) > stats.originalChars * 0.5 ? '<li>‚ö†Ô∏è Significant content change detected (>50% length change)</li>' : ''}\r\n          ${Math.abs(charDiff) < stats.originalChars * 0.1 ? '<li>‚ú® Minor changes detected (<10% length change)</li>' : ''}\r\n        </ul>\r\n        \r\n        <div class=\"ai-note\">\r\n          <p><em>Note: This is a local analysis. For AI-powered insights, please check your Hugging Face API configuration.</em></p>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getFallbackRewrite() {\r\n    return `\r\n      <div class=\"ai-rewrite\">\r\n        <h4>‚ú® Writing Improvement Suggestions (Local Analysis)</h4>\r\n        <div class=\"rewrite-suggestions\">\r\n          <h5>üìù General Writing Tips</h5>\r\n          <ul>\r\n            <li><strong>Clarity:</strong> Use clear, concise language and avoid jargon</li>\r\n            <li><strong>Structure:</strong> Break up long sentences into shorter, more readable ones</li>\r\n            <li><strong>Voice:</strong> Use active voice when possible for stronger impact</li>\r\n            <li><strong>Consistency:</strong> Maintain consistent terminology and tone throughout</li>\r\n            <li><strong>Grammar:</strong> Check for spelling, grammar, and punctuation errors</li>\r\n          </ul>\r\n          \r\n          <h5>üéØ Content Enhancement</h5>\r\n          <ul>\r\n            <li>Remove redundant words and phrases</li>\r\n            <li>Add transitional phrases for better flow</li>\r\n            <li>Use specific examples to support your points</li>\r\n            <li>Ensure each paragraph has a clear main idea</li>\r\n          </ul>\r\n        </div>\r\n        \r\n        <div class=\"ai-note\">\r\n          <p><em>Note: For AI-powered rewrite suggestions, please configure your Hugging Face API key.</em></p>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getFallbackSummary(originalText, changedText) {\r\n    const combinedLength = originalText.length + changedText.length;\r\n    return `\r\n      <div class=\"ai-summary\">\r\n        <h4>üìù Basic Summary</h4>\r\n        <p>AI summarization unavailable. Text contains ${combinedLength} total characters across both versions.</p>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getFallbackToneAnalysis() {\r\n    return `\r\n      <div class=\"ai-tone\">\r\n        <h4>üé≠ Basic Tone Analysis</h4>\r\n        <p>AI tone analysis unavailable. Please review your text manually for tone consistency.</p>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  // Format the response into the expected structure\r\n  formatResponse(type, content) {\r\n    const typeIcons = {\r\n      explain: 'üß†',\r\n      rewrite: '‚ú®',\r\n      summary: 'üìù',\r\n      tone: 'üé≠',\r\n      cleanup: 'üßπ'\r\n    };\r\n\r\n    const typeTitles = {\r\n      explain: 'Hugging Face AI Explanation',\r\n      rewrite: 'Hugging Face AI Rewrite Suggestions',\r\n      summary: 'Hugging Face AI Summary',\r\n      tone: 'Hugging Face AI Tone Analysis',\r\n      cleanup: 'Hugging Face AI Text Cleanup'\r\n    };\r\n\r\n    return {\r\n      title: `${typeIcons[type] || 'ü§ñ'} ${typeTitles[type] || 'Hugging Face AI Analysis'}`,\r\n      content: content,\r\n      type: type\r\n    };\r\n  }\r\n\r\n  // Test the Hugging Face connection\r\n  async testConnection() {\r\n    try {\r\n      const result = await this.callHuggingFaceAPI(this.config.models.textGeneration, {\r\n        inputs: \"Test connection: \",\r\n        parameters: { max_length: 50 }\r\n      });\r\n      return { success: true, response: 'Connection successful!' };\r\n    } catch (error) {\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  // Get available models\r\n  getAvailableModels() {\r\n    return {\r\n      textGeneration: [\r\n        'meta-llama/Llama-2-7b-chat-hf',\r\n        'microsoft/DialoGPT-large',\r\n        'EleutherAI/gpt-neo-2.7B',\r\n        'mistralai/Mistral-7B-Instruct-v0.1',\r\n        'EleutherAI/gpt-neo-1.3B'\r\n      ],\r\n      summarization: [\r\n        'facebook/bart-large-cnn',\r\n        'google/pegasus-xsum',\r\n        't5-base',\r\n        't5-small'\r\n      ],\r\n      sentiment: [\r\n        'cardiffnlp/twitter-roberta-base-sentiment-latest',\r\n        'nlptown/bert-base-multilingual-uncased-sentiment',\r\n        'distilbert-base-uncased-finetuned-sst-2-english'\r\n      ]\r\n    };\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}