{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Joem\\\\quickdiff-react\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport './App.css';\nimport './user-guide.css';\nimport Header from './components/Header';\nimport SettingsPanel from './components/SettingsPanel';\nimport InputSection from './components/InputSection';\nimport Controls from './components/Controls';\nimport Legend from './components/Legend';\nimport Results from './components/Results';\nimport ReactUserGuide from './user-guide.js';\nimport { DiffEngine } from './utils/DiffEngine';\nimport { ExportUtils } from './utils/ExportUtils';\nimport { GroqService } from './utils/GroqService';\nimport { LanguageDetector } from './utils/LanguageDetector';\nimport PDFTextExtractor from './utils/PDFTextExtractor';\nimport { NotificationProvider, useNotification } from './components/NotificationProvider';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction QuickDiffApp() {\n  _s();\n  // State management\n  const [originalText, setOriginalText] = useState('');\n  const [changedText, setChangedText] = useState('');\n  const [diffResult, setDiffResult] = useState(null);\n  const [showResults, setShowResults] = useState(false);\n  const [theme, setTheme] = useState('light');\n  const [contrast, setContrast] = useState('normal');\n\n  // Track last compared texts to prevent AI analysis on uncompared content\n  const [lastComparedOriginal, setLastComparedOriginal] = useState('');\n  const [lastComparedChanged, setLastComparedChanged] = useState('');\n\n  // Settings state\n  const [settings, setSettings] = useState({\n    diffMode: 'line',\n    viewMode: 'side-by-side',\n    language: 'plaintext',\n    autoDetectLanguage: true,\n    ignoreCase: false,\n    ignoreWhitespace: false,\n    ignorePunctuation: false,\n    livePreview: false\n  });\n\n  // Language detection state\n  const [detectedLanguage, setDetectedLanguage] = useState({\n    language: 'plaintext',\n    confidence: 'low',\n    method: 'default'\n  });\n\n  // AI state\n  const [aiResults, setAiResults] = useState([]);\n  const [showAiResults, setShowAiResults] = useState(false);\n  const [isGeneratingAI, setIsGeneratingAI] = useState(false);\n\n  // Navigation state\n  const [changes, setChanges] = useState([]);\n  const [currentChangeIndex, setCurrentChangeIndex] = useState(-1);\n  const [minimapVisible, setMinimapVisible] = useState(false);\n\n  // Initialize user guide\n  useEffect(() => {\n    if (!window.userGuideInitialized) {\n      userGuide.current = new ReactUserGuide();\n      window.userGuideInitialized = true;\n    }\n\n    // Cleanup function\n    return () => {\n      if (userGuide.current) {\n        userGuide.current.destroy();\n        userGuide.current = null;\n      }\n    };\n  }, []);\n\n  // Refs\n  const debounceTimer = useRef(null);\n  const diffEngine = useRef(new DiffEngine());\n  const exportUtils = useRef(new ExportUtils());\n  const groqService = useRef(new GroqService());\n  const languageDetector = useRef(new LanguageDetector());\n  const pdfExtractor = useRef(new PDFTextExtractor());\n  const userGuide = useRef(null);\n  const {\n    showNotification\n  } = useNotification();\n\n  // Settings management functions (defined early to avoid hoisting issues)\n  const loadSettings = () => {\n    try {\n      const savedSettings = localStorage.getItem('quickdiff_react_settings');\n      if (savedSettings) {\n        setSettings(prev => ({\n          ...prev,\n          ...JSON.parse(savedSettings)\n        }));\n      }\n    } catch (error) {\n      console.error('Error loading settings:', error);\n    }\n  };\n  const saveSettings = useCallback(() => {\n    try {\n      localStorage.setItem('quickdiff_react_settings', JSON.stringify(settings));\n    } catch (error) {\n      console.error('Error saving settings:', error);\n    }\n  }, [settings]);\n  const loadTheme = () => {\n    const savedTheme = localStorage.getItem('quickdiff_theme') || 'light';\n    const savedContrast = localStorage.getItem('quickdiff_contrast') || 'normal';\n    setTheme(savedTheme);\n    setContrast(savedContrast);\n    document.documentElement.setAttribute('data-theme', savedTheme);\n    document.documentElement.setAttribute('data-contrast', savedContrast);\n  };\n\n  // Load settings and theme on mount\n  useEffect(() => {\n    loadSettings();\n    loadTheme();\n\n    // Debug AI API configurations\n    console.log('=== QuickDiff App Debug ===');\n    console.log('Environment variables check:');\n    console.log('REACT_APP_GROQ_API_KEY:', process.env.REACT_APP_GROQ_API_KEY ? 'Found' : 'Not found');\n    if (groqService.current) {\n      groqService.current.debugConfig();\n\n      // Make Groq service available globally for testing\n      window.testGroq = async () => {\n        console.log('ðŸ§ª Testing Groq API...');\n        try {\n          const result = await groqService.current.testConnection();\n          console.log('ðŸ§ª Test result:', result);\n          return result;\n        } catch (error) {\n          console.error('ðŸ§ª Test failed:', error);\n          return {\n            success: false,\n            error: error.message\n          };\n        }\n      };\n      console.log('ðŸ’¡ You can test Groq API by running: testGroq() in console');\n    }\n    console.log('========================');\n  }, []);\n\n  // Auto-save settings when they change\n  useEffect(() => {\n    saveSettings();\n  }, [settings, saveSettings]);\n\n  // Collect changes for navigation (defined early to avoid hoisting issues)\n  const collectChanges = useCallback(result => {\n    if (!result) return;\n    const newChanges = [];\n\n    // Handle different diff modes\n    if (settings.diffMode === 'word' || settings.diffMode === 'char') {\n      // For word and character modes, use stats to determine actual change count\n      let changeCount = 0;\n      let changeType = 'modified';\n      let changeDescription = '';\n      if (result.stats) {\n        if (settings.diffMode === 'word') {\n          const wordsAdded = result.stats.wordsAdded || 0;\n          const wordsRemoved = result.stats.wordsRemoved || 0;\n          const wordsModified = result.stats.wordsModified || 0;\n\n          // Use totalChanges if available, otherwise calculate\n          changeCount = result.stats.totalChanges || wordsAdded + wordsRemoved + wordsModified;\n          if (wordsModified > 0) {\n            if (wordsAdded > 0 || wordsRemoved > 0) {\n              changeDescription = `${wordsModified} words modified, ${wordsRemoved} removed, ${wordsAdded} added`;\n            } else {\n              changeDescription = `${wordsModified} words modified`;\n            }\n            changeType = 'modified';\n          } else if (wordsAdded > 0 && wordsRemoved > 0) {\n            changeDescription = `${wordsRemoved} words removed, ${wordsAdded} words added`;\n            changeType = 'modified';\n          } else if (wordsAdded > 0) {\n            changeDescription = `${wordsAdded} words added`;\n            changeType = 'added';\n          } else if (wordsRemoved > 0) {\n            changeDescription = `${wordsRemoved} words removed`;\n            changeType = 'removed';\n          }\n        } else if (settings.diffMode === 'char') {\n          const charsAdded = result.stats.charactersAdded || 0;\n          const charsRemoved = result.stats.charactersRemoved || 0;\n          const charsModified = result.stats.charactersModified || 0;\n\n          // Use totalChanges if available, otherwise calculate\n          changeCount = result.stats.totalChanges || charsAdded + charsRemoved + charsModified;\n          if (charsModified > 0) {\n            if (charsAdded > 0 || charsRemoved > 0) {\n              changeDescription = `${charsModified} characters modified, ${charsRemoved} removed, ${charsAdded} added`;\n            } else {\n              changeDescription = `${charsModified} characters modified`;\n            }\n            changeType = 'modified';\n          } else if (charsAdded > 0 && charsRemoved > 0) {\n            changeDescription = `${charsRemoved} characters removed, ${charsAdded} characters added`;\n            changeType = 'modified';\n          } else if (charsAdded > 0) {\n            changeDescription = `${charsAdded} characters added`;\n            changeType = 'added';\n          } else if (charsRemoved > 0) {\n            changeDescription = `${charsRemoved} characters removed`;\n            changeType = 'removed';\n          }\n        }\n      }\n\n      // Create one change entry when changes are detected\n      if (changeCount > 0) {\n        newChanges.push({\n          lineNumber: 1,\n          type: changeType,\n          content: changeDescription,\n          originalLineNumber: 1,\n          changedLineNumber: 1\n        });\n      }\n    } else {\n      // Line mode - original logic\n      // Extract changes from originalLines (DiffEngine returns originalLines and changedLines)\n      if (result.originalLines) {\n        result.originalLines.forEach((line, index) => {\n          if (line.type && line.type !== 'unchanged' && line.type !== '') {\n            newChanges.push({\n              lineNumber: index + 1,\n              type: line.type,\n              content: line.content || '',\n              originalLineNumber: index + 1,\n              changedLineNumber: index + 1\n            });\n          }\n        });\n      }\n\n      // Also check changedLines for additional changes (like added lines)\n      if (result.changedLines) {\n        result.changedLines.forEach((line, index) => {\n          if (line.type && line.type !== 'unchanged' && line.type !== '') {\n            // Avoid duplicates by checking if we already have this change\n            const exists = newChanges.some(change => change.lineNumber === index + 1 && change.type === line.type);\n            if (!exists) {\n              newChanges.push({\n                lineNumber: index + 1,\n                type: line.type,\n                content: line.content || '',\n                originalLineNumber: index + 1,\n                changedLineNumber: index + 1\n              });\n            }\n          }\n        });\n      }\n    }\n\n    // Sort changes by line number\n    newChanges.sort((a, b) => a.lineNumber - b.lineNumber);\n    console.log('Collected Changes:', newChanges); // Debug log\n    console.log('Diff Mode:', settings.diffMode); // Debug log\n    console.log('Result Stats:', result.stats); // Debug log\n\n    setChanges(newChanges);\n    setCurrentChangeIndex(newChanges.length > 0 ? 0 : -1);\n    if (newChanges.length > 0) {\n      // For word and character modes, show the actual change count from stats\n      if (settings.diffMode === 'word' || settings.diffMode === 'char') {\n        let actualChangeCount = 0;\n        let changeDetails = '';\n        if (result.stats) {\n          if (settings.diffMode === 'word') {\n            // Use totalChanges if available for more accurate count\n            actualChangeCount = result.stats.totalChanges || (result.stats.wordsAdded || 0) + (result.stats.wordsRemoved || 0) + (result.stats.wordsModified || 0);\n            const added = result.stats.wordsAdded || 0;\n            const removed = result.stats.wordsRemoved || 0;\n            const modified = result.stats.wordsModified || 0;\n            if (modified > 0) {\n              changeDetails = `${modified} modified`;\n              if (added > 0 || removed > 0) {\n                changeDetails += `, ${added} added, ${removed} removed`;\n              }\n            } else if (added > 0 && removed > 0) {\n              changeDetails = `${added} added, ${removed} removed`;\n            } else if (added > 0) {\n              changeDetails = `${added} added`;\n            } else if (removed > 0) {\n              changeDetails = `${removed} removed`;\n            }\n          } else if (settings.diffMode === 'char') {\n            // Use totalChanges if available for more accurate count\n            actualChangeCount = result.stats.totalChanges || (result.stats.charactersAdded || 0) + (result.stats.charactersRemoved || 0) + (result.stats.charactersModified || 0);\n            const added = result.stats.charactersAdded || 0;\n            const removed = result.stats.charactersRemoved || 0;\n            const modified = result.stats.charactersModified || 0;\n            if (modified > 0) {\n              changeDetails = `${modified} modified`;\n              if (added > 0 || removed > 0) {\n                changeDetails += `, ${added} added, ${removed} removed`;\n              }\n            } else if (added > 0 && removed > 0) {\n              changeDetails = `${added} added, ${removed} removed`;\n            } else if (added > 0) {\n              changeDetails = `${added} added`;\n            } else if (removed > 0) {\n              changeDetails = `${removed} removed`;\n            }\n          }\n        }\n        if (actualChangeCount > 0) {\n          const unit = settings.diffMode === 'word' ? 'word' : 'character';\n          const plural = actualChangeCount !== 1 ? 's' : '';\n          showNotification(`Found ${actualChangeCount} ${unit}${plural} changed (${changeDetails})`);\n        } else {\n          showNotification('Changes detected');\n        }\n      } else {\n        // Line mode - show number of line changes\n        showNotification(`Found ${newChanges.length} line${newChanges.length !== 1 ? 's' : ''} changed`);\n      }\n    } else {\n      showNotification('No changes detected');\n    }\n  }, [showNotification, settings.diffMode]);\n\n  // Main comparison function (defined early to avoid hoisting issues)\n  const performComparison = useCallback(() => {\n    // Check if both text areas are empty\n    if (!originalText.trim() && !changedText.trim()) {\n      showNotification('âŒ Please enter text in both areas to compare');\n      return;\n    }\n\n    // Check if only one text area has content\n    if (!originalText.trim() || !changedText.trim()) {\n      showNotification('âŒ Please provide text in both Original and Changed areas for comparison');\n      return;\n    }\n    try {\n      const result = diffEngine.current.performComparison(originalText, changedText, settings);\n      console.log('Diff Result:', result); // Debug log\n      setDiffResult(result);\n      setShowResults(true);\n\n      // Store the texts that were just compared\n      setLastComparedOriginal(originalText.trim());\n      setLastComparedChanged(changedText.trim());\n      collectChanges(result);\n\n      // Auto-generate AI analysis is disabled to prevent duplicate results\n      // Users can manually trigger AI analysis using the AI buttons\n\n      // Auto-scroll to results only if live preview is disabled\n      if (!settings.livePreview) {\n        setTimeout(() => {\n          const resultsElement = document.getElementById('results-section');\n          if (resultsElement) {\n            resultsElement.scrollIntoView({\n              behavior: 'smooth',\n              block: 'start'\n            });\n          }\n        }, 100);\n      }\n      showNotification('Comparison completed');\n    } catch (error) {\n      console.error('Comparison error:', error);\n      showNotification('Error performing comparison');\n    }\n  }, [originalText, changedText, settings, showNotification, collectChanges]);\n\n  // File validation helper function\n  const validateFileBeforeLoad = file => {\n    // Check if file exists\n    if (!file) {\n      showNotification('âŒ No file selected');\n      return false;\n    }\n\n    // Check file size is not zero\n    if (file.size === 0) {\n      showNotification(`âŒ File is empty: ${file.name}`);\n      setTimeout(() => {\n        alert(`The selected file appears to be empty: ${file.name}\\n\\nPlease select a file with content.`);\n      }, 100);\n      return false;\n    }\n\n    // Basic file type validation\n    const isPDF = file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf');\n    const isText = file.type.startsWith('text/') || ['.txt', '.md', '.json', '.js', '.html', '.css', '.xml', '.csv'].some(ext => file.name.toLowerCase().endsWith(ext));\n    if (!isPDF && !isText && !file.type.startsWith('text/')) {\n      const message = `Unsupported file type: ${file.name}\\n\\nSupported formats:\\n- Text files (.txt, .md, .js, .html, .css, .json, .xml, .csv)\\n- PDF files (.pdf)`;\n      showNotification('âŒ Unsupported file type');\n      setTimeout(() => {\n        alert(message);\n      }, 100);\n      return false;\n    }\n    return true;\n  };\n\n  // File handling with improved size validation and notifications\n  const handleFileLoad = async (file, target) => {\n    console.log(`ðŸ” Loading file: ${file.name}, Size: ${(file.size / 1024 / 1024).toFixed(1)}MB`);\n\n    // File size limits (in bytes)\n    const MAX_TEXT_FILE_SIZE = 5 * 1024 * 1024; // 5MB for text files\n    const MAX_PDF_FILE_SIZE = 10 * 1024 * 1024; // 10MB for PDF files\n    const RECOMMENDED_SIZE = 1 * 1024 * 1024; // 1MB recommended limit\n\n    // Validate file first\n    if (!validateFileBeforeLoad(file)) {\n      return false;\n    }\n\n    // Check if it's a PDF file\n    const isPDF = pdfExtractor.current.isPDFFile(file);\n    const sizeInMB = (file.size / 1024 / 1024).toFixed(1);\n    console.log(`ðŸ“„ File type: ${isPDF ? 'PDF' : 'Text'}, Size: ${sizeInMB}MB`);\n\n    // IMMEDIATE SIZE CHECK - REJECT OVERSIZED FILES\n    const maxSize = isPDF ? MAX_PDF_FILE_SIZE : MAX_TEXT_FILE_SIZE;\n    const maxSizeMB = (maxSize / 1024 / 1024).toFixed(0);\n    const fileTypeStr = isPDF ? 'PDF' : 'text';\n    if (file.size > maxSize) {\n      console.log(`âŒ ${fileTypeStr.toUpperCase()} FILE REJECTED: ${sizeInMB}MB > ${maxSizeMB}MB`);\n\n      // Create a more prominent error message\n      const errorMessage = `File too large: ${file.name} (${sizeInMB}MB)\\n\\nMaximum allowed size for ${fileTypeStr} files: ${maxSizeMB}MB\\n\\nPlease select a smaller file.`;\n\n      // Show notification immediately\n      showNotification(`âŒ File too large: ${sizeInMB}MB (max: ${maxSizeMB}MB)`);\n\n      // Also show browser alert for guaranteed visibility\n      setTimeout(() => {\n        alert(errorMessage);\n      }, 100);\n\n      // Log the rejection\n      console.log(`ðŸ›‘ FILE PROCESSING TERMINATED: ${errorMessage}`);\n\n      // Early return - no processing occurs\n      return false;\n    }\n\n    // Show warning for large but acceptable files\n    if (file.size > RECOMMENDED_SIZE) {\n      const warningMessage = `âš ï¸ Large file (${sizeInMB}MB) - Processing may be slow`;\n      showNotification(warningMessage);\n      console.log(`âš ï¸ Large file warning: ${sizeInMB}MB > ${(RECOMMENDED_SIZE / 1024 / 1024).toFixed(1)}MB`);\n    }\n    console.log(`âœ… File size acceptable, proceeding with extraction...`);\n\n    // Show loading notification\n    showNotification(`ðŸ“ Loading ${file.name}...`);\n    try {\n      let content = '';\n      if (isPDF) {\n        console.log(`ðŸ“„ Starting PDF extraction for ${file.name}...`);\n        showNotification(`ðŸ“„ Extracting text from PDF: ${file.name}...`);\n        const result = await pdfExtractor.current.extractTextFromPDF(file);\n        if (result.success) {\n          content = result.text;\n          showNotification(`âœ… PDF extracted successfully: ${file.name}`);\n          console.log(`âœ… PDF extraction completed: ${result.message}`);\n        } else {\n          showNotification(`âŒ PDF extraction failed: ${result.error}`);\n          console.error(`âŒ PDF extraction error:`, result.error);\n\n          // Show alert for PDF extraction failures\n          setTimeout(() => {\n            alert(`Failed to extract text from PDF: ${file.name}\\n\\nError: ${result.error}\\n\\nPlease try a different PDF file.`);\n          }, 100);\n          return false;\n        }\n      } else {\n        // Handle text files\n        console.log(`ðŸ“„ Reading text file: ${file.name}...`);\n        showNotification(`ðŸ“„ Reading text file: ${file.name}...`);\n        try {\n          content = await new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = e => {\n              console.log(`âœ… Text file read successfully`);\n              resolve(e.target.result);\n            };\n            reader.onerror = e => {\n              console.error(`âŒ FileReader error:`, e);\n              reject(new Error('Failed to read file - file may be corrupted or in an unsupported format'));\n            };\n            reader.readAsText(file, 'UTF-8'); // Specify UTF-8 encoding\n          });\n          showNotification(`âœ… Text file loaded: ${file.name}`);\n        } catch (readError) {\n          console.error('Text file reading error:', readError);\n          showNotification(`âŒ Failed to read file: ${readError.message}`);\n\n          // Show alert for text file reading failures\n          setTimeout(() => {\n            alert(`Failed to read text file: ${file.name}\\n\\nError: ${readError.message}\\n\\nPlease check the file format and try again.`);\n          }, 100);\n          return false;\n        }\n      }\n\n      // Validate extracted content\n      if (!content || content.trim().length === 0) {\n        const emptyMessage = `File appears to be empty or contains no readable text: ${file.name}`;\n        showNotification(`âš ï¸ ${emptyMessage}`);\n        console.log(`âš ï¸ Empty content warning: ${emptyMessage}`);\n        setTimeout(() => {\n          alert(`${emptyMessage}\\n\\nPlease select a file with text content.`);\n        }, 100);\n        return false;\n      }\n\n      // Check content size after extraction\n      const contentSizeKB = (content.length / 1024).toFixed(1);\n      console.log(`ðŸ“Š Extracted content size: ${contentSizeKB}KB`);\n\n      // Set the content to the appropriate text area\n      if (target === 'original') {\n        setOriginalText(content);\n        console.log(`âœ… Content set to original text area`);\n      } else {\n        setChangedText(content);\n        console.log(`âœ… Content set to changed text area`);\n      }\n\n      // Auto-detect language from filename if enabled\n      if (settings.autoDetectLanguage) {\n        try {\n          const detection = languageDetector.current.autoDetect(content, file.name);\n          setDetectedLanguage(detection);\n          if (detection.language !== 'plaintext') {\n            setSettings(prev => ({\n              ...prev,\n              language: detection.language\n            }));\n            console.log(`ðŸ” Language detected: ${detection.language} (${detection.confidence})`);\n          }\n        } catch (langError) {\n          console.error('Language detection error:', langError);\n          // Don't show notification for language detection errors - not critical\n        }\n      }\n\n      // Trigger live preview if enabled\n      if (settings.livePreview && originalText.trim() && changedText.trim()) {\n        performComparison();\n      }\n\n      // Final success notification\n      const finalMessage = isPDF ? `âœ… PDF processed: ${file.name} (${contentSizeKB}KB text extracted)` : `âœ… File loaded: ${file.name} (${contentSizeKB}KB)`;\n      showNotification(finalMessage);\n      console.log(`ðŸŽ‰ File processing completed successfully: ${file.name}`);\n      return true;\n    } catch (error) {\n      console.error('File processing error:', error);\n      const errorMessage = `Failed to process file: ${file.name}`;\n      showNotification(`âŒ ${errorMessage}`);\n\n      // Show detailed error in alert\n      setTimeout(() => {\n        alert(`${errorMessage}\\n\\nError Details: ${error.message}\\n\\nPlease try a different file or contact support if the issue persists.`);\n      }, 100);\n      return false;\n    }\n  };\n\n  // Theme management\n  const toggleTheme = () => {\n    const newTheme = theme === 'light' ? 'dark' : 'light';\n    setTheme(newTheme);\n    localStorage.setItem('quickdiff_theme', newTheme);\n    document.documentElement.setAttribute('data-theme', newTheme);\n    showNotification(`Switched to ${newTheme} theme`);\n  };\n  const toggleContrast = () => {\n    const newContrast = contrast === 'normal' ? 'high' : 'normal';\n    setContrast(newContrast);\n    localStorage.setItem('quickdiff_contrast', newContrast);\n    document.documentElement.setAttribute('data-contrast', newContrast);\n    showNotification(`${newContrast === 'high' ? 'Enabled' : 'Disabled'} high contrast mode`);\n  };\n\n  // Text manipulation functions\n  const clearAll = () => {\n    setOriginalText('');\n    setChangedText('');\n    setShowResults(false);\n    setDiffResult(null);\n    setAiResults([]);\n    setShowAiResults(false);\n\n    // Clear last compared texts\n    setLastComparedOriginal('');\n    setLastComparedChanged('');\n    showNotification('All content cleared');\n  };\n  const swapTexts = () => {\n    const temp = originalText;\n    setOriginalText(changedText);\n    setChangedText(temp);\n    showNotification('Texts swapped');\n    if (settings.livePreview && originalText.trim() && changedText.trim()) {\n      performComparison();\n    }\n  };\n\n  // Export functions\n  const copyResults = () => {\n    exportUtils.current.copyResults(originalText, changedText, aiResults).then(() => showNotification('Results copied to clipboard')).catch(() => showNotification('Failed to copy results'));\n  };\n  const exportToTxt = () => {\n    exportUtils.current.exportToTxt(originalText, changedText, diffResult, aiResults);\n    showNotification('Exported as TXT file');\n  };\n  const exportToHtml = () => {\n    exportUtils.current.exportToHtml(originalText, changedText, diffResult, aiResults);\n    showNotification('Exported as HTML file');\n  };\n  const exportToMarkdown = () => {\n    exportUtils.current.exportToMarkdown(originalText, changedText, diffResult, aiResults);\n    showNotification('Exported as Markdown file');\n  };\n  const exportToPdf = () => {\n    exportUtils.current.exportToPdf(originalText, changedText, diffResult, aiResults);\n    showNotification('Exported as PDF file');\n  };\n\n  // AI functions\n  const generateAIAnalysis = async type => {\n    // Check if both text areas are empty\n    if (!originalText.trim() && !changedText.trim()) {\n      showNotification('âŒ Please enter text in both areas to analyze');\n      return;\n    }\n\n    // Check if only one text area has content\n    if (!originalText.trim() || !changedText.trim()) {\n      showNotification('âŒ Please provide text in both Original and Changed areas for AI analysis');\n      return;\n    }\n\n    // Check if texts have been compared first\n    // Ensure current texts match what was last compared\n    if (!showResults || !diffResult || originalText.trim() !== lastComparedOriginal || changedText.trim() !== lastComparedChanged) {\n      showNotification('âŒ Please compare the current texts first before running AI analysis (Ctrl+Enter)');\n      return;\n    }\n\n    // Check if this analysis type already exists\n    const existingAnalysisIndex = aiResults.findIndex(result => result.type === type);\n    const isRefreshingExisting = existingAnalysisIndex !== -1;\n    setIsGeneratingAI(true);\n    try {\n      if (groqService.current.isConfigured()) {\n        // Use Groq API when configured\n        if (isRefreshingExisting) {\n          showNotification(`ðŸ”„ Refreshing ${type} analysis with Groq...`);\n        } else {\n          showNotification('Generating AI analysis with Groq...');\n        }\n        const analysis = await groqService.current.generateAnalysis(type, originalText, changedText);\n        if (isRefreshingExisting) {\n          // Replace existing analysis\n          setAiResults(prev => prev.map((result, index) => index === existingAnalysisIndex ? analysis : result));\n          showNotification(`âœ… ${type} analysis refreshed`);\n        } else {\n          // Add new analysis\n          setAiResults(prev => [...prev, analysis]);\n          showNotification('âœ… Groq AI analysis completed');\n        }\n        setShowAiResults(true);\n\n        // Auto-scroll to the latest AI result card\n        setTimeout(() => {\n          const aiCards = document.querySelectorAll('.ai-analysis-card');\n          if (aiCards.length > 0) {\n            // Scroll to the last (newest) AI card\n            const latestCard = aiCards[aiCards.length - 1];\n            latestCard.scrollIntoView({\n              behavior: 'smooth',\n              block: 'start',\n              inline: 'nearest'\n            });\n          }\n        }, 200);\n      } else {\n        // No API configured\n        showNotification('âŒ Groq API not configured. Please set up your API key.');\n        return;\n      }\n    } catch (error) {\n      console.error('AI Analysis Error:', error);\n      showNotification(`âŒ Analysis failed: ${error.message}`);\n    } finally {\n      setIsGeneratingAI(false);\n    }\n  };\n  const clearAIResults = () => {\n    setAiResults([]);\n    setShowAiResults(false);\n    showNotification('AI results cleared');\n  };\n  const removeAICard = index => {\n    setAiResults(prev => prev.filter((_, i) => i !== index));\n    showNotification('AI analysis removed');\n\n    // Hide AI results section if no cards left\n    if (aiResults.length <= 1) {\n      setShowAiResults(false);\n    }\n  };\n\n  // Navigation functions\n  const navigateToPreviousChange = () => {\n    console.log('Navigate Previous - Changes:', changes.length, 'Current Index:', currentChangeIndex); // Debug log\n    if (changes.length === 0) {\n      showNotification('No changes to navigate');\n      return;\n    }\n    const newIndex = currentChangeIndex > 0 ? currentChangeIndex - 1 : changes.length - 1;\n    setCurrentChangeIndex(newIndex);\n    scrollToChange(newIndex);\n  };\n  const navigateToNextChange = () => {\n    console.log('Navigate Next - Changes:', changes.length, 'Current Index:', currentChangeIndex); // Debug log\n    if (changes.length === 0) {\n      showNotification('No changes to navigate');\n      return;\n    }\n    const newIndex = currentChangeIndex < changes.length - 1 ? currentChangeIndex + 1 : 0;\n    setCurrentChangeIndex(newIndex);\n    scrollToChange(newIndex);\n  };\n  const scrollToChange = index => {\n    if (index < 0 || index >= changes.length) return;\n    const change = changes[index];\n\n    // Try multiple selectors to find the line\n    let lineElement = document.querySelector(`[data-line-number=\"${change.lineNumber}\"][data-line-type=\"${change.type}\"]`);\n    if (!lineElement) {\n      lineElement = document.querySelector(`[data-original-line=\"${change.lineNumber}\"]`);\n    }\n    if (!lineElement) {\n      lineElement = document.querySelector(`[data-line-number=\"${change.lineNumber}\"]`);\n    }\n    if (lineElement) {\n      // Remove previous highlights\n      document.querySelectorAll('.current-change').forEach(el => {\n        el.classList.remove('current-change');\n      });\n      lineElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center'\n      });\n\n      // Highlight the current change temporarily\n      lineElement.classList.add('current-change');\n      setTimeout(() => {\n        lineElement.classList.remove('current-change');\n      }, 3000);\n      showNotification(`Navigated to change ${index + 1} of ${changes.length}: ${change.type}`);\n    } else {\n      showNotification(`Could not find change ${index + 1} (line ${change.lineNumber})`);\n    }\n  };\n  const toggleMinimap = () => {\n    setMinimapVisible(!minimapVisible);\n    showNotification(minimapVisible ? 'Minimap hidden' : 'Minimap shown');\n  };\n\n  // Auto-detect language when text changes\n  useEffect(() => {\n    if (settings.autoDetectLanguage && (originalText.trim() || changedText.trim())) {\n      const combinedText = originalText + '\\n' + changedText;\n      const detection = languageDetector.current.autoDetect(combinedText);\n      setDetectedLanguage(detection);\n\n      // Auto-update language setting for ANY detection (including plaintext)\n      if (detection.language !== settings.language) {\n        setSettings(prev => ({\n          ...prev,\n          language: detection.language\n        }));\n\n        // Show notification for language changes\n        if (detection.language === 'plaintext') {\n          console.log('ðŸ” Auto-detected: Plain text');\n        } else {\n          console.log(`ðŸ” Auto-detected: ${detection.language} (${detection.confidence} confidence)`);\n        }\n      }\n    } else if (!settings.autoDetectLanguage) {\n      // Reset to default when auto-detect is disabled\n      setDetectedLanguage({\n        language: 'plaintext',\n        confidence: 'low',\n        method: 'default'\n      });\n    } else if (!originalText.trim() && !changedText.trim()) {\n      // Reset to plaintext when both text areas are empty\n      setDetectedLanguage({\n        language: 'plaintext',\n        confidence: 'high',\n        method: 'empty'\n      });\n      if (settings.language !== 'plaintext') {\n        setSettings(prev => ({\n          ...prev,\n          language: 'plaintext'\n        }));\n      }\n    }\n  }, [originalText, changedText, settings.autoDetectLanguage, settings.language]);\n\n  // Live preview with debouncing\n  useEffect(() => {\n    if (settings.livePreview && originalText.trim() && changedText.trim()) {\n      clearTimeout(debounceTimer.current);\n      debounceTimer.current = setTimeout(() => {\n        performComparison();\n      }, 500);\n    }\n    return () => clearTimeout(debounceTimer.current);\n  }, [originalText, changedText, settings.livePreview, settings.diffMode, settings.ignoreCase, settings.ignoreWhitespace, settings.ignorePunctuation, performComparison]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = e => {\n      const isInTextArea = e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT';\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key.toLowerCase()) {\n          case 'enter':\n            // Always allow Ctrl+Enter for comparison, even in text areas\n            e.preventDefault();\n            performComparison();\n            showNotification('âŒ¨ï¸ Ctrl+Enter: Comparison started');\n            break;\n          case 'k':\n            // Always allow Ctrl+K for clear all, even in text areas\n            e.preventDefault();\n            clearAll();\n            showNotification('âŒ¨ï¸ Ctrl+K: All content cleared');\n            break;\n          case 's':\n            // Always allow Ctrl+S for swap, even in text areas\n            e.preventDefault();\n            swapTexts();\n            showNotification('âŒ¨ï¸ Ctrl+S: Texts swapped');\n            break;\n          case 'c':\n            // Only prevent default for copy results if we have results and not in text area\n            // This allows normal Ctrl+C copy in text areas while still enabling results copy\n            if (showResults && !isInTextArea) {\n              e.preventDefault();\n              copyResults();\n              showNotification('âŒ¨ï¸ Ctrl+C: Results copied');\n            }\n            break;\n          case 'd':\n            // Always allow theme toggle, even in text areas\n            e.preventDefault();\n            toggleTheme();\n            showNotification('âŒ¨ï¸ Ctrl+D: Theme toggled');\n            break;\n          case 'h':\n            // Always allow contrast toggle, even in text areas\n            e.preventDefault();\n            toggleContrast();\n            showNotification('âŒ¨ï¸ Ctrl+H: Contrast toggled');\n            break;\n          case 'm':\n            // Always allow minimap toggle, even in text areas\n            e.preventDefault();\n            toggleMinimap();\n            showNotification('âŒ¨ï¸ Ctrl+M: Minimap toggled');\n            break;\n          default:\n            break;\n        }\n      }\n\n      // Handle Alt shortcuts for AI tools\n      if (e.altKey) {\n        switch (e.key) {\n          case '1':\n            // Alt+1 - Explain\n            e.preventDefault();\n            generateAIAnalysis('explain');\n            showNotification('âŒ¨ï¸ Alt+1: AI Explain started');\n            break;\n          case '2':\n            // Alt+2 - Rewrite\n            e.preventDefault();\n            generateAIAnalysis('rewrite');\n            showNotification('âŒ¨ï¸ Alt+2: AI Rewrite started');\n            break;\n          case '3':\n            // Alt+3 - Summary\n            e.preventDefault();\n            generateAIAnalysis('summary');\n            showNotification('âŒ¨ï¸ Alt+3: AI Summary started');\n            break;\n          case '4':\n            // Alt+4 - Tone\n            e.preventDefault();\n            generateAIAnalysis('tone');\n            showNotification('âŒ¨ï¸ Alt+4: AI Tone analysis started');\n            break;\n          case '5':\n            // Alt+5 - Cleanup\n            e.preventDefault();\n            generateAIAnalysis('cleanup');\n            showNotification('âŒ¨ï¸ Alt+5: AI Cleanup started');\n            break;\n          default:\n            break;\n        }\n      }\n\n      // Handle other shortcuts\n      switch (e.key) {\n        case 'Escape':\n          // Always allow Escape to clear AI results\n          if (showAiResults) {\n            clearAIResults();\n            showNotification('âŒ¨ï¸ Escape: AI results cleared');\n          }\n          break;\n        case 'ArrowUp':\n          // Only allow navigation shortcuts when not typing in text areas\n          if (e.ctrlKey && !isInTextArea) {\n            e.preventDefault();\n            navigateToPreviousChange();\n          }\n          break;\n        case 'ArrowDown':\n          // Only allow navigation shortcuts when not typing in text areas\n          if (e.ctrlKey && !isInTextArea) {\n            e.preventDefault();\n            navigateToNextChange();\n          }\n          break;\n        case 'F1':\n          // Always allow F1 for help, even in text areas\n          e.preventDefault();\n          if (userGuide.current) {\n            userGuide.current.showQuickGuide();\n            showNotification('âŒ¨ï¸ F1: Quick guide opened');\n          }\n          break;\n        default:\n          break;\n      }\n    };\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [showResults, showAiResults, performComparison, clearAll, swapTexts, copyResults, toggleTheme, toggleContrast, toggleMinimap, clearAIResults, navigateToPreviousChange, navigateToNextChange, generateAIAnalysis, showNotification]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"quickdiff-app\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        onThemeToggle: toggleTheme,\n        onContrastToggle: toggleContrast\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1053,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SettingsPanel, {\n        settings: settings,\n        onSettingsChange: setSettings,\n        detectedLanguage: detectedLanguage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1058,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InputSection, {\n        originalText: originalText,\n        changedText: changedText,\n        onOriginalTextChange: setOriginalText,\n        onChangedTextChange: setChangedText,\n        onFileLoad: handleFileLoad\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1064,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {\n        onCompare: performComparison,\n        onClear: clearAll,\n        onSwap: swapTexts,\n        onCopy: copyResults,\n        onExportTxt: exportToTxt,\n        onExportHtml: exportToHtml,\n        onExportMd: exportToMarkdown,\n        onExportPdf: exportToPdf,\n        onAIAnalysis: generateAIAnalysis,\n        hasResults: showResults,\n        isGeneratingAI: isGeneratingAI,\n        groqConfigured: groqService.current.isConfigured()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1072,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1087,\n        columnNumber: 9\n      }, this), showResults && /*#__PURE__*/_jsxDEV(Results, {\n        diffResult: diffResult,\n        settings: settings,\n        changes: changes,\n        currentChangeIndex: currentChangeIndex,\n        minimapVisible: minimapVisible,\n        onNavigatePrevious: navigateToPreviousChange,\n        onNavigateNext: navigateToNextChange,\n        onToggleMinimap: toggleMinimap,\n        onNavigateToChange: index => {\n          setCurrentChangeIndex(index);\n          scrollToChange(index);\n        },\n        aiResults: aiResults,\n        showAiResults: showAiResults,\n        onClearAIResults: clearAIResults,\n        onRemoveAICard: removeAICard\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1090,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1052,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1051,\n    columnNumber: 5\n  }, this);\n}\n_s(QuickDiffApp, \"K1zYTAiNx3U24Zr0rR/WU79EOVw=\", false, function () {\n  return [useNotification];\n});\n_c = QuickDiffApp;\nfunction App() {\n  return /*#__PURE__*/_jsxDEV(NotificationProvider, {\n    children: /*#__PURE__*/_jsxDEV(QuickDiffApp, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1117,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1116,\n    columnNumber: 5\n  }, this);\n}\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"QuickDiffApp\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Header","SettingsPanel","InputSection","Controls","Legend","Results","ReactUserGuide","DiffEngine","ExportUtils","GroqService","LanguageDetector","PDFTextExtractor","NotificationProvider","useNotification","jsxDEV","_jsxDEV","QuickDiffApp","_s","originalText","setOriginalText","changedText","setChangedText","diffResult","setDiffResult","showResults","setShowResults","theme","setTheme","contrast","setContrast","lastComparedOriginal","setLastComparedOriginal","lastComparedChanged","setLastComparedChanged","settings","setSettings","diffMode","viewMode","language","autoDetectLanguage","ignoreCase","ignoreWhitespace","ignorePunctuation","livePreview","detectedLanguage","setDetectedLanguage","confidence","method","aiResults","setAiResults","showAiResults","setShowAiResults","isGeneratingAI","setIsGeneratingAI","changes","setChanges","currentChangeIndex","setCurrentChangeIndex","minimapVisible","setMinimapVisible","window","userGuideInitialized","userGuide","current","destroy","debounceTimer","diffEngine","exportUtils","groqService","languageDetector","pdfExtractor","showNotification","loadSettings","savedSettings","localStorage","getItem","prev","JSON","parse","error","console","saveSettings","setItem","stringify","loadTheme","savedTheme","savedContrast","document","documentElement","setAttribute","log","process","env","REACT_APP_GROQ_API_KEY","debugConfig","testGroq","result","testConnection","success","message","collectChanges","newChanges","changeCount","changeType","changeDescription","stats","wordsAdded","wordsRemoved","wordsModified","totalChanges","charsAdded","charactersAdded","charsRemoved","charactersRemoved","charsModified","charactersModified","push","lineNumber","type","content","originalLineNumber","changedLineNumber","originalLines","forEach","line","index","changedLines","exists","some","change","sort","a","b","length","actualChangeCount","changeDetails","added","removed","modified","unit","plural","performComparison","trim","setTimeout","resultsElement","getElementById","scrollIntoView","behavior","block","validateFileBeforeLoad","file","size","name","alert","isPDF","toLowerCase","endsWith","isText","startsWith","ext","handleFileLoad","target","toFixed","MAX_TEXT_FILE_SIZE","MAX_PDF_FILE_SIZE","RECOMMENDED_SIZE","isPDFFile","sizeInMB","maxSize","maxSizeMB","fileTypeStr","toUpperCase","errorMessage","warningMessage","extractTextFromPDF","text","Promise","resolve","reject","reader","FileReader","onload","e","onerror","Error","readAsText","readError","emptyMessage","contentSizeKB","detection","autoDetect","langError","finalMessage","toggleTheme","newTheme","toggleContrast","newContrast","clearAll","swapTexts","temp","copyResults","then","catch","exportToTxt","exportToHtml","exportToMarkdown","exportToPdf","generateAIAnalysis","existingAnalysisIndex","findIndex","isRefreshingExisting","isConfigured","analysis","generateAnalysis","map","aiCards","querySelectorAll","latestCard","inline","clearAIResults","removeAICard","filter","_","i","navigateToPreviousChange","newIndex","scrollToChange","navigateToNextChange","lineElement","querySelector","el","classList","remove","add","toggleMinimap","combinedText","clearTimeout","handleKeyDown","isInTextArea","tagName","ctrlKey","metaKey","key","preventDefault","altKey","showQuickGuide","addEventListener","removeEventListener","className","children","onThemeToggle","onContrastToggle","fileName","_jsxFileName","columnNumber","onSettingsChange","onOriginalTextChange","onChangedTextChange","onFileLoad","onCompare","onClear","onSwap","onCopy","onExportTxt","onExportHtml","onExportMd","onExportPdf","onAIAnalysis","hasResults","groqConfigured","onNavigatePrevious","onNavigateNext","onToggleMinimap","onNavigateToChange","onClearAIResults","onRemoveAICard","_c","App","_c2","$RefreshReg$"],"sources":["C:/Users/Joem/quickdiff-react/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport './App.css';\r\nimport './user-guide.css';\r\nimport Header from './components/Header';\r\nimport SettingsPanel from './components/SettingsPanel';\r\nimport InputSection from './components/InputSection';\r\nimport Controls from './components/Controls';\r\nimport Legend from './components/Legend';\r\nimport Results from './components/Results';\r\nimport ReactUserGuide from './user-guide.js';\r\nimport { DiffEngine } from './utils/DiffEngine';\r\nimport { ExportUtils } from './utils/ExportUtils';\r\nimport { GroqService } from './utils/GroqService';\r\nimport { LanguageDetector } from './utils/LanguageDetector';\r\nimport PDFTextExtractor from './utils/PDFTextExtractor';\r\nimport { NotificationProvider, useNotification } from './components/NotificationProvider';\r\n\r\nfunction QuickDiffApp() {\r\n  // State management\r\n  const [originalText, setOriginalText] = useState('');\r\n  const [changedText, setChangedText] = useState('');\r\n  const [diffResult, setDiffResult] = useState(null);\r\n  const [showResults, setShowResults] = useState(false);\r\n  const [theme, setTheme] = useState('light');\r\n  const [contrast, setContrast] = useState('normal');\r\n  \r\n  // Track last compared texts to prevent AI analysis on uncompared content\r\n  const [lastComparedOriginal, setLastComparedOriginal] = useState('');\r\n  const [lastComparedChanged, setLastComparedChanged] = useState('');\r\n  \r\n  // Settings state\r\n  const [settings, setSettings] = useState({\r\n    diffMode: 'line',\r\n    viewMode: 'side-by-side',\r\n    language: 'plaintext',\r\n    autoDetectLanguage: true,\r\n    ignoreCase: false,\r\n    ignoreWhitespace: false,\r\n    ignorePunctuation: false,\r\n    livePreview: false\r\n  });\r\n\r\n  // Language detection state\r\n  const [detectedLanguage, setDetectedLanguage] = useState({\r\n    language: 'plaintext',\r\n    confidence: 'low',\r\n    method: 'default'\r\n  });\r\n\r\n  // AI state\r\n  const [aiResults, setAiResults] = useState([]);\r\n  const [showAiResults, setShowAiResults] = useState(false);\r\n  const [isGeneratingAI, setIsGeneratingAI] = useState(false);\r\n\r\n  // Navigation state\r\n  const [changes, setChanges] = useState([]);\r\n  const [currentChangeIndex, setCurrentChangeIndex] = useState(-1);\r\n  const [minimapVisible, setMinimapVisible] = useState(false);\r\n  \r\n  // Initialize user guide\r\n  useEffect(() => {\r\n    if (!window.userGuideInitialized) {\r\n      userGuide.current = new ReactUserGuide();\r\n      window.userGuideInitialized = true;\r\n    }\r\n    \r\n    // Cleanup function\r\n    return () => {\r\n      if (userGuide.current) {\r\n        userGuide.current.destroy();\r\n        userGuide.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Refs\r\n  const debounceTimer = useRef(null);\r\n  const diffEngine = useRef(new DiffEngine());\r\n  const exportUtils = useRef(new ExportUtils());\r\n  const groqService = useRef(new GroqService());\r\n  const languageDetector = useRef(new LanguageDetector());\r\n  const pdfExtractor = useRef(new PDFTextExtractor());\r\n  const userGuide = useRef(null);\r\n  \r\n  const { showNotification } = useNotification();\r\n\r\n  // Settings management functions (defined early to avoid hoisting issues)\r\n  const loadSettings = () => {\r\n    try {\r\n      const savedSettings = localStorage.getItem('quickdiff_react_settings');\r\n      if (savedSettings) {\r\n        setSettings(prev => ({ ...prev, ...JSON.parse(savedSettings) }));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading settings:', error);\r\n    }\r\n  };\r\n\r\n  const saveSettings = useCallback(() => {\r\n    try {\r\n      localStorage.setItem('quickdiff_react_settings', JSON.stringify(settings));\r\n    } catch (error) {\r\n      console.error('Error saving settings:', error);\r\n    }\r\n  }, [settings]);\r\n\r\n  const loadTheme = () => {\r\n    const savedTheme = localStorage.getItem('quickdiff_theme') || 'light';\r\n    const savedContrast = localStorage.getItem('quickdiff_contrast') || 'normal';\r\n    setTheme(savedTheme);\r\n    setContrast(savedContrast);\r\n    document.documentElement.setAttribute('data-theme', savedTheme);\r\n    document.documentElement.setAttribute('data-contrast', savedContrast);\r\n  };\r\n\r\n  // Load settings and theme on mount\r\n  useEffect(() => {\r\n    loadSettings();\r\n    loadTheme();\r\n    \r\n    // Debug AI API configurations\r\n    console.log('=== QuickDiff App Debug ===');\r\n    console.log('Environment variables check:');\r\n    console.log('REACT_APP_GROQ_API_KEY:', process.env.REACT_APP_GROQ_API_KEY ? 'Found' : 'Not found');\r\n    \r\n    if (groqService.current) {\r\n      groqService.current.debugConfig();\r\n      \r\n      // Make Groq service available globally for testing\r\n      window.testGroq = async () => {\r\n        console.log('ðŸ§ª Testing Groq API...');\r\n        try {\r\n          const result = await groqService.current.testConnection();\r\n          console.log('ðŸ§ª Test result:', result);\r\n          return result;\r\n        } catch (error) {\r\n          console.error('ðŸ§ª Test failed:', error);\r\n          return { success: false, error: error.message };\r\n        }\r\n      };\r\n      \r\n      console.log('ðŸ’¡ You can test Groq API by running: testGroq() in console');\r\n    }\r\n    console.log('========================');\r\n  }, []);\r\n\r\n  // Auto-save settings when they change\r\n  useEffect(() => {\r\n    saveSettings();\r\n  }, [settings, saveSettings]);\r\n\r\n  // Collect changes for navigation (defined early to avoid hoisting issues)\r\n  const collectChanges = useCallback((result) => {\r\n    if (!result) return;\r\n    \r\n    const newChanges = [];\r\n    \r\n    // Handle different diff modes\r\n    if (settings.diffMode === 'word' || settings.diffMode === 'char') {\r\n      // For word and character modes, use stats to determine actual change count\r\n      let changeCount = 0;\r\n      let changeType = 'modified';\r\n      let changeDescription = '';\r\n      \r\n      if (result.stats) {\r\n        if (settings.diffMode === 'word') {\r\n          const wordsAdded = result.stats.wordsAdded || 0;\r\n          const wordsRemoved = result.stats.wordsRemoved || 0;\r\n          const wordsModified = result.stats.wordsModified || 0;\r\n          \r\n          // Use totalChanges if available, otherwise calculate\r\n          changeCount = result.stats.totalChanges || (wordsAdded + wordsRemoved + wordsModified);\r\n          \r\n          if (wordsModified > 0) {\r\n            if (wordsAdded > 0 || wordsRemoved > 0) {\r\n              changeDescription = `${wordsModified} words modified, ${wordsRemoved} removed, ${wordsAdded} added`;\r\n            } else {\r\n              changeDescription = `${wordsModified} words modified`;\r\n            }\r\n            changeType = 'modified';\r\n          } else if (wordsAdded > 0 && wordsRemoved > 0) {\r\n            changeDescription = `${wordsRemoved} words removed, ${wordsAdded} words added`;\r\n            changeType = 'modified';\r\n          } else if (wordsAdded > 0) {\r\n            changeDescription = `${wordsAdded} words added`;\r\n            changeType = 'added';\r\n          } else if (wordsRemoved > 0) {\r\n            changeDescription = `${wordsRemoved} words removed`;\r\n            changeType = 'removed';\r\n          }\r\n        } else if (settings.diffMode === 'char') {\r\n          const charsAdded = result.stats.charactersAdded || 0;\r\n          const charsRemoved = result.stats.charactersRemoved || 0;\r\n          const charsModified = result.stats.charactersModified || 0;\r\n          \r\n          // Use totalChanges if available, otherwise calculate\r\n          changeCount = result.stats.totalChanges || (charsAdded + charsRemoved + charsModified);\r\n          \r\n          if (charsModified > 0) {\r\n            if (charsAdded > 0 || charsRemoved > 0) {\r\n              changeDescription = `${charsModified} characters modified, ${charsRemoved} removed, ${charsAdded} added`;\r\n            } else {\r\n              changeDescription = `${charsModified} characters modified`;\r\n            }\r\n            changeType = 'modified';\r\n          } else if (charsAdded > 0 && charsRemoved > 0) {\r\n            changeDescription = `${charsRemoved} characters removed, ${charsAdded} characters added`;\r\n            changeType = 'modified';\r\n          } else if (charsAdded > 0) {\r\n            changeDescription = `${charsAdded} characters added`;\r\n            changeType = 'added';\r\n          } else if (charsRemoved > 0) {\r\n            changeDescription = `${charsRemoved} characters removed`;\r\n            changeType = 'removed';\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Create one change entry when changes are detected\r\n      if (changeCount > 0) {\r\n        newChanges.push({\r\n          lineNumber: 1,\r\n          type: changeType,\r\n          content: changeDescription,\r\n          originalLineNumber: 1,\r\n          changedLineNumber: 1\r\n        });\r\n      }\r\n      \r\n    } else {\r\n      // Line mode - original logic\r\n      // Extract changes from originalLines (DiffEngine returns originalLines and changedLines)\r\n      if (result.originalLines) {\r\n        result.originalLines.forEach((line, index) => {\r\n          if (line.type && line.type !== 'unchanged' && line.type !== '') {\r\n            newChanges.push({\r\n              lineNumber: index + 1,\r\n              type: line.type,\r\n              content: line.content || '',\r\n              originalLineNumber: index + 1,\r\n              changedLineNumber: index + 1\r\n            });\r\n          }\r\n        });\r\n      }\r\n      \r\n      // Also check changedLines for additional changes (like added lines)\r\n      if (result.changedLines) {\r\n        result.changedLines.forEach((line, index) => {\r\n          if (line.type && line.type !== 'unchanged' && line.type !== '') {\r\n            // Avoid duplicates by checking if we already have this change\r\n            const exists = newChanges.some(change => \r\n              change.lineNumber === index + 1 && change.type === line.type\r\n            );\r\n            if (!exists) {\r\n              newChanges.push({\r\n                lineNumber: index + 1,\r\n                type: line.type,\r\n                content: line.content || '',\r\n                originalLineNumber: index + 1,\r\n                changedLineNumber: index + 1\r\n              });\r\n            }\r\n          }\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Sort changes by line number\r\n    newChanges.sort((a, b) => a.lineNumber - b.lineNumber);\r\n    \r\n    console.log('Collected Changes:', newChanges); // Debug log\r\n    console.log('Diff Mode:', settings.diffMode); // Debug log\r\n    console.log('Result Stats:', result.stats); // Debug log\r\n    \r\n    setChanges(newChanges);\r\n    setCurrentChangeIndex(newChanges.length > 0 ? 0 : -1);\r\n    \r\n    if (newChanges.length > 0) {\r\n      // For word and character modes, show the actual change count from stats\r\n      if (settings.diffMode === 'word' || settings.diffMode === 'char') {\r\n        let actualChangeCount = 0;\r\n        let changeDetails = '';\r\n        \r\n        if (result.stats) {\r\n          if (settings.diffMode === 'word') {\r\n            // Use totalChanges if available for more accurate count\r\n            actualChangeCount = result.stats.totalChanges || \r\n              ((result.stats.wordsAdded || 0) + (result.stats.wordsRemoved || 0) + (result.stats.wordsModified || 0));\r\n            \r\n            const added = result.stats.wordsAdded || 0;\r\n            const removed = result.stats.wordsRemoved || 0;\r\n            const modified = result.stats.wordsModified || 0;\r\n            \r\n            if (modified > 0) {\r\n              changeDetails = `${modified} modified`;\r\n              if (added > 0 || removed > 0) {\r\n                changeDetails += `, ${added} added, ${removed} removed`;\r\n              }\r\n            } else if (added > 0 && removed > 0) {\r\n              changeDetails = `${added} added, ${removed} removed`;\r\n            } else if (added > 0) {\r\n              changeDetails = `${added} added`;\r\n            } else if (removed > 0) {\r\n              changeDetails = `${removed} removed`;\r\n            }\r\n          } else if (settings.diffMode === 'char') {\r\n            // Use totalChanges if available for more accurate count\r\n            actualChangeCount = result.stats.totalChanges || \r\n              ((result.stats.charactersAdded || 0) + (result.stats.charactersRemoved || 0) + (result.stats.charactersModified || 0));\r\n            \r\n            const added = result.stats.charactersAdded || 0;\r\n            const removed = result.stats.charactersRemoved || 0;\r\n            const modified = result.stats.charactersModified || 0;\r\n            \r\n            if (modified > 0) {\r\n              changeDetails = `${modified} modified`;\r\n              if (added > 0 || removed > 0) {\r\n                changeDetails += `, ${added} added, ${removed} removed`;\r\n              }\r\n            } else if (added > 0 && removed > 0) {\r\n              changeDetails = `${added} added, ${removed} removed`;\r\n            } else if (added > 0) {\r\n              changeDetails = `${added} added`;\r\n            } else if (removed > 0) {\r\n              changeDetails = `${removed} removed`;\r\n            }\r\n          }\r\n        }\r\n        \r\n        if (actualChangeCount > 0) {\r\n          const unit = settings.diffMode === 'word' ? 'word' : 'character';\r\n          const plural = actualChangeCount !== 1 ? 's' : '';\r\n          showNotification(`Found ${actualChangeCount} ${unit}${plural} changed (${changeDetails})`);\r\n        } else {\r\n          showNotification('Changes detected');\r\n        }\r\n      } else {\r\n        // Line mode - show number of line changes\r\n        showNotification(`Found ${newChanges.length} line${newChanges.length !== 1 ? 's' : ''} changed`);\r\n      }\r\n    } else {\r\n      showNotification('No changes detected');\r\n    }\r\n  }, [showNotification, settings.diffMode]);\r\n\r\n  // Main comparison function (defined early to avoid hoisting issues)\r\n  const performComparison = useCallback(() => {\r\n    // Check if both text areas are empty\r\n    if (!originalText.trim() && !changedText.trim()) {\r\n      showNotification('âŒ Please enter text in both areas to compare');\r\n      return;\r\n    }\r\n    \r\n    // Check if only one text area has content\r\n    if (!originalText.trim() || !changedText.trim()) {\r\n      showNotification('âŒ Please provide text in both Original and Changed areas for comparison');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = diffEngine.current.performComparison(\r\n        originalText,\r\n        changedText,\r\n        settings\r\n      );\r\n\r\n      console.log('Diff Result:', result); // Debug log\r\n      setDiffResult(result);\r\n      setShowResults(true);\r\n      \r\n      // Store the texts that were just compared\r\n      setLastComparedOriginal(originalText.trim());\r\n      setLastComparedChanged(changedText.trim());\r\n      \r\n      collectChanges(result);\r\n      \r\n      // Auto-generate AI analysis is disabled to prevent duplicate results\r\n      // Users can manually trigger AI analysis using the AI buttons\r\n      \r\n      // Auto-scroll to results only if live preview is disabled\r\n      if (!settings.livePreview) {\r\n        setTimeout(() => {\r\n          const resultsElement = document.getElementById('results-section');\r\n          if (resultsElement) {\r\n            resultsElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n          }\r\n        }, 100);\r\n      }\r\n\r\n      showNotification('Comparison completed');\r\n    } catch (error) {\r\n      console.error('Comparison error:', error);\r\n      showNotification('Error performing comparison');\r\n    }\r\n  }, [originalText, changedText, settings, showNotification, collectChanges]);\r\n\r\n  // File validation helper function\r\n  const validateFileBeforeLoad = (file) => {\r\n    // Check if file exists\r\n    if (!file) {\r\n      showNotification('âŒ No file selected');\r\n      return false;\r\n    }\r\n    \r\n    // Check file size is not zero\r\n    if (file.size === 0) {\r\n      showNotification(`âŒ File is empty: ${file.name}`);\r\n      setTimeout(() => {\r\n        alert(`The selected file appears to be empty: ${file.name}\\n\\nPlease select a file with content.`);\r\n      }, 100);\r\n      return false;\r\n    }\r\n    \r\n    // Basic file type validation\r\n    const isPDF = file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf');\r\n    const isText = file.type.startsWith('text/') || \r\n                   ['.txt', '.md', '.json', '.js', '.html', '.css', '.xml', '.csv'].some(ext => \r\n                     file.name.toLowerCase().endsWith(ext));\r\n    \r\n    if (!isPDF && !isText && !file.type.startsWith('text/')) {\r\n      const message = `Unsupported file type: ${file.name}\\n\\nSupported formats:\\n- Text files (.txt, .md, .js, .html, .css, .json, .xml, .csv)\\n- PDF files (.pdf)`;\r\n      showNotification('âŒ Unsupported file type');\r\n      setTimeout(() => {\r\n        alert(message);\r\n      }, 100);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  };\r\n\r\n  // File handling with improved size validation and notifications\r\n  const handleFileLoad = async (file, target) => {\r\n    console.log(`ðŸ” Loading file: ${file.name}, Size: ${(file.size / 1024 / 1024).toFixed(1)}MB`);\r\n    \r\n    // File size limits (in bytes)\r\n    const MAX_TEXT_FILE_SIZE = 5 * 1024 * 1024; // 5MB for text files\r\n    const MAX_PDF_FILE_SIZE = 10 * 1024 * 1024; // 10MB for PDF files\r\n    const RECOMMENDED_SIZE = 1 * 1024 * 1024; // 1MB recommended limit\r\n    \r\n    // Validate file first\r\n    if (!validateFileBeforeLoad(file)) {\r\n      return false;\r\n    }\r\n    \r\n    // Check if it's a PDF file\r\n    const isPDF = pdfExtractor.current.isPDFFile(file);\r\n    const sizeInMB = (file.size / 1024 / 1024).toFixed(1);\r\n    \r\n    console.log(`ðŸ“„ File type: ${isPDF ? 'PDF' : 'Text'}, Size: ${sizeInMB}MB`);\r\n    \r\n    // IMMEDIATE SIZE CHECK - REJECT OVERSIZED FILES\r\n    const maxSize = isPDF ? MAX_PDF_FILE_SIZE : MAX_TEXT_FILE_SIZE;\r\n    const maxSizeMB = (maxSize / 1024 / 1024).toFixed(0);\r\n    const fileTypeStr = isPDF ? 'PDF' : 'text';\r\n    \r\n    if (file.size > maxSize) {\r\n      console.log(`âŒ ${fileTypeStr.toUpperCase()} FILE REJECTED: ${sizeInMB}MB > ${maxSizeMB}MB`);\r\n      \r\n      // Create a more prominent error message\r\n      const errorMessage = `File too large: ${file.name} (${sizeInMB}MB)\\n\\nMaximum allowed size for ${fileTypeStr} files: ${maxSizeMB}MB\\n\\nPlease select a smaller file.`;\r\n      \r\n      // Show notification immediately\r\n      showNotification(`âŒ File too large: ${sizeInMB}MB (max: ${maxSizeMB}MB)`);\r\n      \r\n      // Also show browser alert for guaranteed visibility\r\n      setTimeout(() => {\r\n        alert(errorMessage);\r\n      }, 100);\r\n      \r\n      // Log the rejection\r\n      console.log(`ðŸ›‘ FILE PROCESSING TERMINATED: ${errorMessage}`);\r\n      \r\n      // Early return - no processing occurs\r\n      return false;\r\n    }\r\n    \r\n    // Show warning for large but acceptable files\r\n    if (file.size > RECOMMENDED_SIZE) {\r\n      const warningMessage = `âš ï¸ Large file (${sizeInMB}MB) - Processing may be slow`;\r\n      showNotification(warningMessage);\r\n      console.log(`âš ï¸ Large file warning: ${sizeInMB}MB > ${(RECOMMENDED_SIZE / 1024 / 1024).toFixed(1)}MB`);\r\n    }\r\n    \r\n    console.log(`âœ… File size acceptable, proceeding with extraction...`);\r\n    \r\n    // Show loading notification\r\n    showNotification(`ðŸ“ Loading ${file.name}...`);\r\n    \r\n    try {\r\n      let content = '';\r\n      \r\n      if (isPDF) {\r\n        console.log(`ðŸ“„ Starting PDF extraction for ${file.name}...`);\r\n        showNotification(`ðŸ“„ Extracting text from PDF: ${file.name}...`);\r\n        \r\n        const result = await pdfExtractor.current.extractTextFromPDF(file);\r\n        \r\n        if (result.success) {\r\n          content = result.text;\r\n          showNotification(`âœ… PDF extracted successfully: ${file.name}`);\r\n          console.log(`âœ… PDF extraction completed: ${result.message}`);\r\n        } else {\r\n          showNotification(`âŒ PDF extraction failed: ${result.error}`);\r\n          console.error(`âŒ PDF extraction error:`, result.error);\r\n          \r\n          // Show alert for PDF extraction failures\r\n          setTimeout(() => {\r\n            alert(`Failed to extract text from PDF: ${file.name}\\n\\nError: ${result.error}\\n\\nPlease try a different PDF file.`);\r\n          }, 100);\r\n          \r\n          return false;\r\n        }\r\n      } else {\r\n        // Handle text files\r\n        console.log(`ðŸ“„ Reading text file: ${file.name}...`);\r\n        showNotification(`ðŸ“„ Reading text file: ${file.name}...`);\r\n        \r\n        try {\r\n          content = await new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n              console.log(`âœ… Text file read successfully`);\r\n              resolve(e.target.result);\r\n            };\r\n            reader.onerror = (e) => {\r\n              console.error(`âŒ FileReader error:`, e);\r\n              reject(new Error('Failed to read file - file may be corrupted or in an unsupported format'));\r\n            };\r\n            reader.readAsText(file, 'UTF-8'); // Specify UTF-8 encoding\r\n          });\r\n          \r\n          showNotification(`âœ… Text file loaded: ${file.name}`);\r\n        } catch (readError) {\r\n          console.error('Text file reading error:', readError);\r\n          showNotification(`âŒ Failed to read file: ${readError.message}`);\r\n          \r\n          // Show alert for text file reading failures\r\n          setTimeout(() => {\r\n            alert(`Failed to read text file: ${file.name}\\n\\nError: ${readError.message}\\n\\nPlease check the file format and try again.`);\r\n          }, 100);\r\n          \r\n          return false;\r\n        }\r\n      }\r\n      \r\n      // Validate extracted content\r\n      if (!content || content.trim().length === 0) {\r\n        const emptyMessage = `File appears to be empty or contains no readable text: ${file.name}`;\r\n        showNotification(`âš ï¸ ${emptyMessage}`);\r\n        console.log(`âš ï¸ Empty content warning: ${emptyMessage}`);\r\n        \r\n        setTimeout(() => {\r\n          alert(`${emptyMessage}\\n\\nPlease select a file with text content.`);\r\n        }, 100);\r\n        \r\n        return false;\r\n      }\r\n      \r\n      // Check content size after extraction\r\n      const contentSizeKB = (content.length / 1024).toFixed(1);\r\n      console.log(`ðŸ“Š Extracted content size: ${contentSizeKB}KB`);\r\n      \r\n      // Set the content to the appropriate text area\r\n      if (target === 'original') {\r\n        setOriginalText(content);\r\n        console.log(`âœ… Content set to original text area`);\r\n      } else {\r\n        setChangedText(content);\r\n        console.log(`âœ… Content set to changed text area`);\r\n      }\r\n      \r\n      // Auto-detect language from filename if enabled\r\n      if (settings.autoDetectLanguage) {\r\n        try {\r\n          const detection = languageDetector.current.autoDetect(content, file.name);\r\n          setDetectedLanguage(detection);\r\n          \r\n          if (detection.language !== 'plaintext') {\r\n            setSettings(prev => ({\r\n              ...prev,\r\n              language: detection.language\r\n            }));\r\n            console.log(`ðŸ” Language detected: ${detection.language} (${detection.confidence})`);\r\n          }\r\n        } catch (langError) {\r\n          console.error('Language detection error:', langError);\r\n          // Don't show notification for language detection errors - not critical\r\n        }\r\n      }\r\n      \r\n      // Trigger live preview if enabled\r\n      if (settings.livePreview && originalText.trim() && changedText.trim()) {\r\n        performComparison();\r\n      }\r\n      \r\n      // Final success notification\r\n      const finalMessage = isPDF \r\n        ? `âœ… PDF processed: ${file.name} (${contentSizeKB}KB text extracted)`\r\n        : `âœ… File loaded: ${file.name} (${contentSizeKB}KB)`;\r\n      \r\n      showNotification(finalMessage);\r\n      console.log(`ðŸŽ‰ File processing completed successfully: ${file.name}`);\r\n      \r\n      return true;\r\n      \r\n    } catch (error) {\r\n      console.error('File processing error:', error);\r\n      const errorMessage = `Failed to process file: ${file.name}`;\r\n      showNotification(`âŒ ${errorMessage}`);\r\n      \r\n      // Show detailed error in alert\r\n      setTimeout(() => {\r\n        alert(`${errorMessage}\\n\\nError Details: ${error.message}\\n\\nPlease try a different file or contact support if the issue persists.`);\r\n      }, 100);\r\n      \r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Theme management\r\n  const toggleTheme = () => {\r\n    const newTheme = theme === 'light' ? 'dark' : 'light';\r\n    setTheme(newTheme);\r\n    localStorage.setItem('quickdiff_theme', newTheme);\r\n    document.documentElement.setAttribute('data-theme', newTheme);\r\n    showNotification(`Switched to ${newTheme} theme`);\r\n  };\r\n\r\n  const toggleContrast = () => {\r\n    const newContrast = contrast === 'normal' ? 'high' : 'normal';\r\n    setContrast(newContrast);\r\n    localStorage.setItem('quickdiff_contrast', newContrast);\r\n    document.documentElement.setAttribute('data-contrast', newContrast);\r\n    showNotification(`${newContrast === 'high' ? 'Enabled' : 'Disabled'} high contrast mode`);\r\n  };\r\n\r\n  // Text manipulation functions\r\n  const clearAll = () => {\r\n    setOriginalText('');\r\n    setChangedText('');\r\n    setShowResults(false);\r\n    setDiffResult(null);\r\n    setAiResults([]);\r\n    setShowAiResults(false);\r\n    \r\n    // Clear last compared texts\r\n    setLastComparedOriginal('');\r\n    setLastComparedChanged('');\r\n    \r\n    showNotification('All content cleared');\r\n  };\r\n\r\n  const swapTexts = () => {\r\n    const temp = originalText;\r\n    setOriginalText(changedText);\r\n    setChangedText(temp);\r\n    showNotification('Texts swapped');\r\n    \r\n    if (settings.livePreview && originalText.trim() && changedText.trim()) {\r\n      performComparison();\r\n    }\r\n  };\r\n\r\n  // Export functions\r\n  const copyResults = () => {\r\n    exportUtils.current.copyResults(originalText, changedText, aiResults)\r\n      .then(() => showNotification('Results copied to clipboard'))\r\n      .catch(() => showNotification('Failed to copy results'));\r\n  };\r\n\r\n  const exportToTxt = () => {\r\n    exportUtils.current.exportToTxt(originalText, changedText, diffResult, aiResults);\r\n    showNotification('Exported as TXT file');\r\n  };\r\n\r\n  const exportToHtml = () => {\r\n    exportUtils.current.exportToHtml(originalText, changedText, diffResult, aiResults);\r\n    showNotification('Exported as HTML file');\r\n  };\r\n\r\n  const exportToMarkdown = () => {\r\n    exportUtils.current.exportToMarkdown(originalText, changedText, diffResult, aiResults);\r\n    showNotification('Exported as Markdown file');\r\n  };\r\n\r\n  const exportToPdf = () => {\r\n    exportUtils.current.exportToPdf(originalText, changedText, diffResult, aiResults);\r\n    showNotification('Exported as PDF file');\r\n  };\r\n\r\n  // AI functions\r\n  const generateAIAnalysis = async (type) => {\r\n    // Check if both text areas are empty\r\n    if (!originalText.trim() && !changedText.trim()) {\r\n      showNotification('âŒ Please enter text in both areas to analyze');\r\n      return;\r\n    }\r\n    \r\n    // Check if only one text area has content\r\n    if (!originalText.trim() || !changedText.trim()) {\r\n      showNotification('âŒ Please provide text in both Original and Changed areas for AI analysis');\r\n      return;\r\n    }\r\n\r\n    // Check if texts have been compared first\r\n    // Ensure current texts match what was last compared\r\n    if (!showResults || !diffResult || \r\n        originalText.trim() !== lastComparedOriginal || \r\n        changedText.trim() !== lastComparedChanged) {\r\n      showNotification('âŒ Please compare the current texts first before running AI analysis (Ctrl+Enter)');\r\n      return;\r\n    }\r\n\r\n    // Check if this analysis type already exists\r\n    const existingAnalysisIndex = aiResults.findIndex(result => result.type === type);\r\n    const isRefreshingExisting = existingAnalysisIndex !== -1;\r\n\r\n    setIsGeneratingAI(true);\r\n    try {\r\n      if (groqService.current.isConfigured()) {\r\n        // Use Groq API when configured\r\n        if (isRefreshingExisting) {\r\n          showNotification(`ðŸ”„ Refreshing ${type} analysis with Groq...`);\r\n        } else {\r\n          showNotification('Generating AI analysis with Groq...');\r\n        }\r\n        \r\n        const analysis = await groqService.current.generateAnalysis(type, originalText, changedText);\r\n        \r\n        if (isRefreshingExisting) {\r\n          // Replace existing analysis\r\n          setAiResults(prev => prev.map((result, index) => \r\n            index === existingAnalysisIndex ? analysis : result\r\n          ));\r\n          showNotification(`âœ… ${type} analysis refreshed`);\r\n        } else {\r\n          // Add new analysis\r\n          setAiResults(prev => [...prev, analysis]);\r\n          showNotification('âœ… Groq AI analysis completed');\r\n        }\r\n        \r\n        setShowAiResults(true);\r\n        \r\n        // Auto-scroll to the latest AI result card\r\n        setTimeout(() => {\r\n          const aiCards = document.querySelectorAll('.ai-analysis-card');\r\n          if (aiCards.length > 0) {\r\n            // Scroll to the last (newest) AI card\r\n            const latestCard = aiCards[aiCards.length - 1];\r\n            latestCard.scrollIntoView({ \r\n              behavior: 'smooth', \r\n              block: 'start',\r\n              inline: 'nearest'\r\n            });\r\n          }\r\n        }, 200);\r\n        \r\n      } else {\r\n        // No API configured\r\n        showNotification('âŒ Groq API not configured. Please set up your API key.');\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      console.error('AI Analysis Error:', error);\r\n      showNotification(`âŒ Analysis failed: ${error.message}`);\r\n    } finally {\r\n      setIsGeneratingAI(false);\r\n    }\r\n  };\r\n\r\n  const clearAIResults = () => {\r\n    setAiResults([]);\r\n    setShowAiResults(false);\r\n    showNotification('AI results cleared');\r\n  };\r\n\r\n  const removeAICard = (index) => {\r\n    setAiResults(prev => prev.filter((_, i) => i !== index));\r\n    showNotification('AI analysis removed');\r\n    \r\n    // Hide AI results section if no cards left\r\n    if (aiResults.length <= 1) {\r\n      setShowAiResults(false);\r\n    }\r\n  };\r\n\r\n  // Navigation functions\r\n  const navigateToPreviousChange = () => {\r\n    console.log('Navigate Previous - Changes:', changes.length, 'Current Index:', currentChangeIndex); // Debug log\r\n    if (changes.length === 0) {\r\n      showNotification('No changes to navigate');\r\n      return;\r\n    }\r\n    \r\n    const newIndex = currentChangeIndex > 0 ? currentChangeIndex - 1 : changes.length - 1;\r\n    setCurrentChangeIndex(newIndex);\r\n    scrollToChange(newIndex);\r\n  };\r\n\r\n  const navigateToNextChange = () => {\r\n    console.log('Navigate Next - Changes:', changes.length, 'Current Index:', currentChangeIndex); // Debug log\r\n    if (changes.length === 0) {\r\n      showNotification('No changes to navigate');\r\n      return;\r\n    }\r\n    \r\n    const newIndex = currentChangeIndex < changes.length - 1 ? currentChangeIndex + 1 : 0;\r\n    setCurrentChangeIndex(newIndex);\r\n    scrollToChange(newIndex);\r\n  };\r\n\r\n  const scrollToChange = (index) => {\r\n    if (index < 0 || index >= changes.length) return;\r\n    \r\n    const change = changes[index];\r\n    \r\n    // Try multiple selectors to find the line\r\n    let lineElement = document.querySelector(`[data-line-number=\"${change.lineNumber}\"][data-line-type=\"${change.type}\"]`);\r\n    \r\n    if (!lineElement) {\r\n      lineElement = document.querySelector(`[data-original-line=\"${change.lineNumber}\"]`);\r\n    }\r\n    \r\n    if (!lineElement) {\r\n      lineElement = document.querySelector(`[data-line-number=\"${change.lineNumber}\"]`);\r\n    }\r\n    \r\n    if (lineElement) {\r\n      // Remove previous highlights\r\n      document.querySelectorAll('.current-change').forEach(el => {\r\n        el.classList.remove('current-change');\r\n      });\r\n      \r\n      lineElement.scrollIntoView({ \r\n        behavior: 'smooth', \r\n        block: 'center' \r\n      });\r\n      \r\n      // Highlight the current change temporarily\r\n      lineElement.classList.add('current-change');\r\n      setTimeout(() => {\r\n        lineElement.classList.remove('current-change');\r\n      }, 3000);\r\n      \r\n      showNotification(`Navigated to change ${index + 1} of ${changes.length}: ${change.type}`);\r\n    } else {\r\n      showNotification(`Could not find change ${index + 1} (line ${change.lineNumber})`);\r\n    }\r\n  };\r\n\r\n  const toggleMinimap = () => {\r\n    setMinimapVisible(!minimapVisible);\r\n    showNotification(minimapVisible ? 'Minimap hidden' : 'Minimap shown');\r\n  };\r\n\r\n  // Auto-detect language when text changes\r\n  useEffect(() => {\r\n    if (settings.autoDetectLanguage && (originalText.trim() || changedText.trim())) {\r\n      const combinedText = originalText + '\\n' + changedText;\r\n      const detection = languageDetector.current.autoDetect(combinedText);\r\n      \r\n      setDetectedLanguage(detection);\r\n      \r\n      // Auto-update language setting for ANY detection (including plaintext)\r\n      if (detection.language !== settings.language) {\r\n        setSettings(prev => ({\r\n          ...prev,\r\n          language: detection.language\r\n        }));\r\n        \r\n        // Show notification for language changes\r\n        if (detection.language === 'plaintext') {\r\n          console.log('ðŸ” Auto-detected: Plain text');\r\n        } else {\r\n          console.log(`ðŸ” Auto-detected: ${detection.language} (${detection.confidence} confidence)`);\r\n        }\r\n      }\r\n    } else if (!settings.autoDetectLanguage) {\r\n      // Reset to default when auto-detect is disabled\r\n      setDetectedLanguage({\r\n        language: 'plaintext',\r\n        confidence: 'low',\r\n        method: 'default'\r\n      });\r\n    } else if (!originalText.trim() && !changedText.trim()) {\r\n      // Reset to plaintext when both text areas are empty\r\n      setDetectedLanguage({\r\n        language: 'plaintext',\r\n        confidence: 'high',\r\n        method: 'empty'\r\n      });\r\n      if (settings.language !== 'plaintext') {\r\n        setSettings(prev => ({\r\n          ...prev,\r\n          language: 'plaintext'\r\n        }));\r\n      }\r\n    }\r\n  }, [originalText, changedText, settings.autoDetectLanguage, settings.language]);\r\n\r\n  // Live preview with debouncing\r\n  useEffect(() => {\r\n    if (settings.livePreview && originalText.trim() && changedText.trim()) {\r\n      clearTimeout(debounceTimer.current);\r\n      debounceTimer.current = setTimeout(() => {\r\n        performComparison();\r\n      }, 500);\r\n    }\r\n    \r\n    return () => clearTimeout(debounceTimer.current);\r\n  }, [originalText, changedText, settings.livePreview, settings.diffMode, settings.ignoreCase, settings.ignoreWhitespace, settings.ignorePunctuation, performComparison]);\r\n\r\n  // Keyboard shortcuts\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      const isInTextArea = e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT';\r\n      \r\n      if (e.ctrlKey || e.metaKey) {\r\n        switch (e.key.toLowerCase()) {\r\n          case 'enter':\r\n            // Always allow Ctrl+Enter for comparison, even in text areas\r\n            e.preventDefault();\r\n            performComparison();\r\n            showNotification('âŒ¨ï¸ Ctrl+Enter: Comparison started');\r\n            break;\r\n          case 'k':\r\n            // Always allow Ctrl+K for clear all, even in text areas\r\n            e.preventDefault();\r\n            clearAll();\r\n            showNotification('âŒ¨ï¸ Ctrl+K: All content cleared');\r\n            break;\r\n          case 's':\r\n            // Always allow Ctrl+S for swap, even in text areas\r\n            e.preventDefault();\r\n            swapTexts();\r\n            showNotification('âŒ¨ï¸ Ctrl+S: Texts swapped');\r\n            break;\r\n          case 'c':\r\n            // Only prevent default for copy results if we have results and not in text area\r\n            // This allows normal Ctrl+C copy in text areas while still enabling results copy\r\n            if (showResults && !isInTextArea) {\r\n              e.preventDefault();\r\n              copyResults();\r\n              showNotification('âŒ¨ï¸ Ctrl+C: Results copied');\r\n            }\r\n            break;\r\n          case 'd':\r\n            // Always allow theme toggle, even in text areas\r\n            e.preventDefault();\r\n            toggleTheme();\r\n            showNotification('âŒ¨ï¸ Ctrl+D: Theme toggled');\r\n            break;\r\n          case 'h':\r\n            // Always allow contrast toggle, even in text areas\r\n            e.preventDefault();\r\n            toggleContrast();\r\n            showNotification('âŒ¨ï¸ Ctrl+H: Contrast toggled');\r\n            break;\r\n          case 'm':\r\n            // Always allow minimap toggle, even in text areas\r\n            e.preventDefault();\r\n            toggleMinimap();\r\n            showNotification('âŒ¨ï¸ Ctrl+M: Minimap toggled');\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n      \r\n      // Handle Alt shortcuts for AI tools\r\n      if (e.altKey) {\r\n        switch (e.key) {\r\n          case '1':\r\n            // Alt+1 - Explain\r\n            e.preventDefault();\r\n            generateAIAnalysis('explain');\r\n            showNotification('âŒ¨ï¸ Alt+1: AI Explain started');\r\n            break;\r\n          case '2':\r\n            // Alt+2 - Rewrite\r\n            e.preventDefault();\r\n            generateAIAnalysis('rewrite');\r\n            showNotification('âŒ¨ï¸ Alt+2: AI Rewrite started');\r\n            break;\r\n          case '3':\r\n            // Alt+3 - Summary\r\n            e.preventDefault();\r\n            generateAIAnalysis('summary');\r\n            showNotification('âŒ¨ï¸ Alt+3: AI Summary started');\r\n            break;\r\n          case '4':\r\n            // Alt+4 - Tone\r\n            e.preventDefault();\r\n            generateAIAnalysis('tone');\r\n            showNotification('âŒ¨ï¸ Alt+4: AI Tone analysis started');\r\n            break;\r\n          case '5':\r\n            // Alt+5 - Cleanup\r\n            e.preventDefault();\r\n            generateAIAnalysis('cleanup');\r\n            showNotification('âŒ¨ï¸ Alt+5: AI Cleanup started');\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n      \r\n      // Handle other shortcuts\r\n      switch (e.key) {\r\n        case 'Escape':\r\n          // Always allow Escape to clear AI results\r\n          if (showAiResults) {\r\n            clearAIResults();\r\n            showNotification('âŒ¨ï¸ Escape: AI results cleared');\r\n          }\r\n          break;\r\n        case 'ArrowUp':\r\n          // Only allow navigation shortcuts when not typing in text areas\r\n          if (e.ctrlKey && !isInTextArea) {\r\n            e.preventDefault();\r\n            navigateToPreviousChange();\r\n          }\r\n          break;\r\n        case 'ArrowDown':\r\n          // Only allow navigation shortcuts when not typing in text areas\r\n          if (e.ctrlKey && !isInTextArea) {\r\n            e.preventDefault();\r\n            navigateToNextChange();\r\n          }\r\n          break;\r\n        case 'F1':\r\n          // Always allow F1 for help, even in text areas\r\n          e.preventDefault();\r\n          if (userGuide.current) {\r\n            userGuide.current.showQuickGuide();\r\n            showNotification('âŒ¨ï¸ F1: Quick guide opened');\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [showResults, showAiResults, performComparison, clearAll, swapTexts, copyResults, toggleTheme, toggleContrast, toggleMinimap, clearAIResults, navigateToPreviousChange, navigateToNextChange, generateAIAnalysis, showNotification]);\r\n\r\n  return (\r\n    <div className=\"quickdiff-app\">\r\n      <div className=\"container\">\r\n        <Header \r\n          onThemeToggle={toggleTheme}\r\n          onContrastToggle={toggleContrast}\r\n        />\r\n        \r\n        <SettingsPanel \r\n          settings={settings}\r\n          onSettingsChange={setSettings}\r\n          detectedLanguage={detectedLanguage}\r\n        />\r\n        \r\n        <InputSection\r\n          originalText={originalText}\r\n          changedText={changedText}\r\n          onOriginalTextChange={setOriginalText}\r\n          onChangedTextChange={setChangedText}\r\n          onFileLoad={handleFileLoad}\r\n        />\r\n        \r\n        <Controls\r\n          onCompare={performComparison}\r\n          onClear={clearAll}\r\n          onSwap={swapTexts}\r\n          onCopy={copyResults}\r\n          onExportTxt={exportToTxt}\r\n          onExportHtml={exportToHtml}\r\n          onExportMd={exportToMarkdown}\r\n          onExportPdf={exportToPdf}\r\n          onAIAnalysis={generateAIAnalysis}\r\n          hasResults={showResults}\r\n          isGeneratingAI={isGeneratingAI}\r\n          groqConfigured={groqService.current.isConfigured()}\r\n        />\r\n        \r\n        <Legend />\r\n        \r\n        {showResults && (\r\n          <Results\r\n            diffResult={diffResult}\r\n            settings={settings}\r\n            changes={changes}\r\n            currentChangeIndex={currentChangeIndex}\r\n            minimapVisible={minimapVisible}\r\n            onNavigatePrevious={navigateToPreviousChange}\r\n            onNavigateNext={navigateToNextChange}\r\n            onToggleMinimap={toggleMinimap}\r\n            onNavigateToChange={(index) => {\r\n              setCurrentChangeIndex(index);\r\n              scrollToChange(index);\r\n            }}\r\n            aiResults={aiResults}\r\n            showAiResults={showAiResults}\r\n            onClearAIResults={clearAIResults}\r\n            onRemoveAICard={removeAICard}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction App() {\r\n  return (\r\n    <NotificationProvider>\r\n      <QuickDiffApp />\r\n    </NotificationProvider>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}